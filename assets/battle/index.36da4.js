System.register("chunks:///_virtual/battle",["./battleGame.ts","./BattleMainUI.ts"],(function(){"use strict";return{setters:[null,null],execute:function(){}}}));

System.register("chunks:///_virtual/battleGame.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NRole.ts","./SkillTxt.ts","./NConst.ts","./NGlobal.ts","./NEnum.ts","./WeaponTxt.ts"],(function(t){"use strict";var e,i,n,l,o,s,r,a,f,h,u,_,p,c,m,d,g,b,k,w,L,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,l=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,r=t.Prefab,a=t.Node,f=t.Label,h=t.sp,u=t.JsonAsset,_=t.Button,p=t.tween,c=t.v3,m=t.Component,d=t.instantiate},function(t){g=t.NRole},function(t){b=t.SkillTxt},function(t){k=t.C_BUNDLE_LIST},function(t){w=t.NGlobal},function(t){L=t.E_CAMP},function(t){y=t.WeaponTxt}],execute:function(){var C,S,v,E,I,A,D,x,N,R,T,z,B,P,F,K,G,j,M,U,H,O,W,q,J,Q,V;o._RF.push({},"d66b0ZPrjlLSL6QhVfqT9F/","battleGame",void 0);var Z=s.ccclass,X=s.property;t("battleGame",(C=Z("battleGame"),S=X(g),v=X(g),E=X(r),I=X([a]),A=X(a),D=X(a),x=X(f),N=X(f),R=X(f),T=X(h.Skeleton),z=X(u),B=X(_),C((K=e((F=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,n(e,"role_letf",K,l(e)),n(e,"role_right",G,l(e)),n(e,"pf_skillEff",j,l(e)),n(e,"n_effList",M,l(e)),n(e,"n_skillInfoLeft",U,l(e)),n(e,"n_skillInfoRight",H,l(e)),n(e,"lbl_weapon",O,l(e)),n(e,"lbl_skill",W,l(e)),n(e,"lbl_time",q,l(e)),n(e,"spn_skillShowEff",J,l(e)),n(e,"json_weaponSkill",Q,l(e)),n(e,"btn_test",V,l(e)),e._wpIdx=void 0,e._wpList=void 0,e._fireCamp=void 0,e._battleTime=void 0,e._roundIdx=void 0,e._effNum=void 0,e}i(e,t);var o=e.prototype;return o.onLoad=function(){this._battleTime=0,this._wpList=[],this._fireCamp=[],this.role_letf.setCompleteListener(this.roleCompleteListener.bind(this,this.role_letf.spn_body)),this.role_right.setCompleteListener(this.roleCompleteListener.bind(this,this.role_letf.spn_body)),this.spn_skillShowEff.setCompleteListener(this.spnSkillShowEffCompleteListener.bind(this)),this.spn_skillShowEff.timeScale=2},o.start=function(){this.enterBattle(),this.btn_test.node.on(_.EventType.CLICK,this.btn_test_click,this),this._wpIdx=0,this._roundIdx=-1,this.spn_skillShowEff.node.active=!1},o.spnSkillShowEffCompleteListener=function(t){this.spn_skillShowEff.node.active=!1},o.roleCompleteListener=function(t,e){switch(t.getCurrent(0).animation.name){case"hit_1":t.setAnimation(0,"idle_1",!0)}},o.roletEventListener=function(t,e){},o.btn_test_click=function(){},o.enterBattle=function(){var t=this;this.role_letf.changePartColor(w.userData.gameUD.petColorCfg[0].componentConfigList),this.role_letf.setAnimation(0,"run",!0),this.role_letf.node.setPosition(-900,-190,0),p(this.role_letf.node).to(1,{position:c(-450,-190,0)}).call((function(){t.role_letf.setAnimation(0,"idle_1",!0)})).delay(.5).call((function(){t.startFight()})).start(),this.role_right.changePartColor(w.userData.gameUD.petColorCfg[1].componentConfigList),this.role_right.setAnimation(0,"run",!0),this.role_right.node.setPosition(900,-190,0),p(this.role_right.node).to(1,{position:c(450,-190,0)}).call((function(){t.role_right.setAnimation(0,"idle_1",!0)})).start()},o.startFight=function(){this._wpList=w.userData.gameUD.weaponList,this._fireCamp=w.userData.gameUD.fireCamp,this.startNextRound()},o.resetRoundData=function(){this._effNum=0,this.role_letf.setAnimation(0,"idle_1",!0),this.role_right.setAnimation(0,"idle_1",!0)},o.startNextRound=function(){if(this._roundIdx++,!(this._roundIdx>=this._wpList.length)){this.resetRoundData();var t=this._wpList[this._roundIdx],e=this._fireCamp[this._roundIdx],i=e==L.LEFT?this.role_letf:this.role_right;this.showSkillInfo(i,t,e)}},o.getLanguageByKey=function(t){if(t){for(var e=t.split("."),i=this.json_weaponSkill.json,n=0;n<e.length;n++)if(!(i=i[e[n]]))return"";return i||""}},o.showSkillInfo=function(t,e,i){var n=this,l=y.getDataByKey(e),o=b.getDataByKey(l.skillId);this.lbl_weapon.string=String(this.getLanguageByKey(l.name)),this.lbl_skill.string=String(this.getLanguageByKey(o.name)),p(this.n_skillInfoRight).to(.3,{position:c(-100,0,0)}).start(),p(this.n_skillInfoLeft).to(.3,{position:c(100,0,0)}).delay(.5).call((function(){n.n_skillInfoLeft.setPosition(-1e3,0),n.n_skillInfoRight.setPosition(1e3,0),n.fireSkill(t,e,i)})).start(),this.spn_skillShowEff.node.active=!0,this.spn_skillShowEff.setAnimation(0,"act_1",!1)},o.fireSkill=function(t,e,i,n){var l=y.getDataByKey(e),o=b.getDataByKey(l.skillId);t.setAnimation(0,o.playerAni,!1),this._effNum=o.effectAnis.length,this.createSkillEffect(t,i,e,o)},o.createSkillEffect=function(t,e,i,n){for(var l=this,o=function(o){var s=n.effectAnis[o];w.AssteMgr.loadResAsync("res/skill/"+i+"/"+i,k.COMMON,h.SkeletonData).then((function(i){var n=d(l.pf_skillEff).getComponent(h.Skeleton);n.skeletonData=i,n.node.setParent(l.n_effList[o]),n.node.setScale(e==L.RIGHT?1:-1,1),n.node.setPosition(t.node.getPosition()),n.setAnimation(0,s,!1),n.setEventListener(l.effAniamEvent.bind(l)),n.setCompleteListener(l.effAnimaComplete.bind(l,n))}))},s=0;s<n.effectAnis.length;s++)o(s)},o.effAniamEvent=function(t,e){"knock"==e.data.name&&(this._fireCamp[this._roundIdx]==L.LEFT?this.role_right:this.role_letf).setAnimation(0,"hit_1",!1)},o.effAnimaComplete=function(t,e){t.node.destroy(),this._effNum--,0==this._effNum&&(this._roundIdx==this._wpList.length-1?this.endBattle():this.startNextRound())},o.endBattle=function(){var t=this._fireCamp[this._roundIdx],e=t==L.LEFT?this.role_letf:this.role_right,i=t==L.LEFT?this.role_right:this.role_letf;e.setAnimation(0,"win",!0),i.setAnimation(0,"die",!1)},e}(m)).prototype,"role_letf",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=e(F.prototype,"role_right",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=e(F.prototype,"pf_skillEff",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=e(F.prototype,"n_effList",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=e(F.prototype,"n_skillInfoLeft",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=e(F.prototype,"n_skillInfoRight",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=e(F.prototype,"lbl_weapon",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=e(F.prototype,"lbl_skill",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=e(F.prototype,"lbl_time",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=e(F.prototype,"spn_skillShowEff",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=e(F.prototype,"json_weaponSkill",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=e(F.prototype,"btn_test",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=F))||P));o._RF.pop()}}}));

System.register("chunks:///_virtual/BattleMainUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NGlobal.ts","./NEnum.ts"],(function(t){"use strict";var n,e,o,r,a,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,r=t.Component},function(t){a=t.NGlobal},function(t){i=t.E_StageType}],execute:function(){var c;e._RF.push({},"73c26jrb2dG7pNp1SNJkJxa","BattleMainUI",void 0);var u=o.ccclass;o.property,t("BattleMainUI",u("BattleMainUI")(c=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){a.audioMgr.playMusic(i.BATTLE)},e}(r))||c);e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/battle', 'chunks:///_virtual/battle'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});