window.__require=function t(e,i,s){function o(n,a){if(!i[n]){if(!e[n]){var l=n.split("/");if(l=l[l.length-1],!e[l]){var u="function"==typeof __require&&__require;if(!a&&u)return u(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+n+"'")}n=l}var h=i[n]={exports:{}};e[n][0].call(h.exports,function(t){return o(e[n][1][t]||t)},h,h.exports,t,e,i,s)}return i[n].exports}for(var r="function"==typeof __require&&__require,n=0;n<s.length;n++)o(s[n]);return o}({GroupTitle:[function(t,e,i){"use strict";cc._RF.push(e,"b23baEejEZFILeZt9mZY78h","GroupTitle");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Boot/scirpt/AppConst"),n=t("../Controller/RummyController"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onConstruct=function(){this.colorController=this.getController("c1"),this.title=this.getChild("title").asTextField},e.prototype.setColor=function(t){this.colorController.setSelectedIndex(t)},e.prototype.getColor=function(){return this.colorController.selectedIndex},e.prototype.setTitle=function(t){this.title.text=t},e.prototype.initData=function(t,e){var i="1"==r.AppConst.languageType?"english":"hindi",s=n.default.instance.view;0==t?(this.setColor(1),this.setTitle(xgameTable.getComplanguageRummyById(56)[i]+"("+e+")"),s.allPoints+=e):14==t?s._first_group?s._first_group&&!s._second_group?(s._second_group=!0,this.setColor(0),this.setTitle(xgameTable.getComplanguageRummyById(52)[i])):(this.setColor(0),this.setTitle(xgameTable.getComplanguageRummyById(55)[i])):(s._first_group=!0,this.setColor(0),this.setTitle(xgameTable.getComplanguageRummyById(51)[i])):t>2?s._first_group&&!s._second_group?(s._second_group=!0,this.setColor(0),this.setTitle(xgameTable.getComplanguageRummyById(52)[i])):s._first_group||s._second_group?(this.setColor(0),this.setTitle(xgameTable.getComplanguageRummyById(53)[i])):(this.setColor(1),this.setTitle(xgameTable.getComplanguageRummyById(56)[i]+"("+e+")"),s.allPoints+=e):s._first_group&&s._second_group?(this.setColor(2),this.setTitle(xgameTable.getComplanguageRummyById(54)[i])):s._first_group&&!s._second_group?(this.setColor(3),this.setTitle(xgameTable.getComplanguageRummyById(56)[i]+"("+e+")")):s._first_group||(this.setColor(3),this.setTitle(xgameTable.getComplanguageRummyById(56)[i]+"("+e+")"),s.allPoints+=e)},e}(fgui.GComponent);i.default=a,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../Controller/RummyController":"RummyController"}],MainScene:[function(t,e,i){"use strict";cc._RF.push(e,"0458bTpithGFLRtduYgtBtq","MainScene");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,s){var o,r=arguments.length,n=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(n=(r<3?o(n):r>3?o(e,i,n):o(e,i))||n);return r>3&&n&&Object.defineProperty(e,i,n),n},n=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(o,r){function n(t){try{l(s.next(t))}catch(e){r(e)}}function a(t){try{l(s.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(n,a)}l((s=s.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,s,o,r,n={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,s&&(o=2&r[0]?s.return:r[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,r[1])).done)return o;switch(s=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,s=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if(!(o=(o=n.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){n.label=r[1];break}if(6===r[0]&&n.label<o[1]){n.label=o[1],o=r;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(r);break}o[2]&&n.ops.pop(),n.trys.pop();continue}r=e.call(t,n)}catch(a){r=[6,a],s=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var l=t("../../../../Common/script/base/AudioManager"),u=t("../../../../Common/script/base/BaseCode"),h=t("../../../../Common/script/base/BaseFrameNative"),c=t("../../../../Common/script/base/CommonCtr"),p=t("../../../../Common/script/base/CommonView"),d=t("../../../../Common/script/base/MgrNative"),m=t("../../../../Common/script/base/ReconnectManager"),_=t("../../../../Common/script/base/ReportManager"),f=t("../../../../Common/script/base/SceneManager"),y=t("../../../../Common/script/base/ViewBase"),g=t("../../../../Boot/scirpt/AppConst"),b=t("../../../../Common/script/util/UIUtil"),v=t("../../../../GameHall/script/Module/ChatView/ChatView"),C=t("../../../../GameHall/script/Module/ComSettingView/ComSettingView"),P=t("../../../../GameHall/script/Module/GiftView/GiftView"),w=t("../../../../GameHall/script/Module/RechargeView/RechargeView"),k=t("../Controller/RummyController"),T=t("../Model/Rummy"),M=t("../Model/RummyModel"),S=t("./GroupTitle"),x=t("./Player"),I=t("./Poker"),R=t("./RummyFinish"),N=t("./RummyHelp"),A=t("./RummyResout"),O=t("./RummyResoutItem"),G=cc._decorator.ccclass,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chatView=null,e.settingView=null,e.helpInfo=null,e.players=[],e.sendPokerPoint=[],e.ui_centercom=null,e.ui_pokerNode=null,e.ui_btn_pokerback=null,e.ui_LeprosyCard=null,e.ui_OutCard=null,e.ui_btn_outlog=null,e.ui_btn_exit=null,e.ui_btn_discard=null,e.ui_btn_declare=null,e.ui_btn_group=null,e.ui_btn_drop=null,e.ui_btn_sort=null,e.ui_coins=null,e.ui_groupNode=null,e.pokerResStart="ui://rummy/cards",e.ui_btn_prepare=null,e.isFinish=!1,e.commonPoker=0,e.commonPoker2=0,e.ui_allPoints=null,e.ui_outPokerPanel=null,e.ui_outPokerList=null,e.mySitDown=!1,e.ui_menu=null,e.ui_btn_toHall=null,e.ui_btn_setting=null,e.ui_setClick=null,e.ui_myInfo=null,e.pokerPool=[],e.myPokers=[],e.myCards=[],e.sortCards=[],e.giveupPoker=[],e.gameState=0,e.ui_btn_help=null,e.myDrop=!1,e.ui_btn_newGroup=null,e.ui_arrow1=null,e.ui_arrow2=null,e.ui_closeNum=null,e.ui_openNum=null,e.finishView=null,e.ui_waitTurn=null,e.ui_pickTip=null,e.ui_pokerLinght1=null,e.ui_pokerLinght2=null,e.ui_lineout=null,e.ui_pokerDropMask=null,e.ui_cardTimeOut=null,e.ui_finishCard=null,e.ui_cardStart=null,e.ui_cardEff=null,e.ui_myTips=null,e.ui_tipstitle=null,e.tipsControlle=null,e.ui_tipstimes=null,e.ui_btn_switchtable=null,e.ui_statrWait=null,e.ui_waittimeer=null,e.ui_finishbg=null,e.ui_finish=null,e.ui_rummyBet=null,e.ui_btn_transposition=null,e.outPokerColor=new cc.Color,e.ui_btn_finish=null,e.ui_rummy_lab_sort=null,e.ui_rummy_lab_discard=null,e.ui_rummy_lab_Declare=null,e.ui_rummy_lab_Finish=null,e.ui_rummy_lab_Group=null,e.ui_rummy_lab_drop=null,e.ui_rummy_lab_back=null,e.ui_rummy_lab_waiting=null,e.ui_rummy_lab_waitingS=null,e.ui_rummy_lab_pick=null,e.ui_rummy_lab_turn=null,e.ui_rummy_lab_points=null,e.ui_rummy_lab_chips=null,e.ui_rummy_lab_exit=null,e.ui_rummy_lab_table=null,e.ui_rummy_lab_help=null,e.ui_rummy_lab_setting=null,e.ui_btn_addcash=null,e.ui_nomoney=null,e.ui_viewcom=null,e.ui_btn_view=null,e.ui_statrWaitone=null,e.ui_view_lab=null,e.ui_btn_view_lab=null,e.ui_one_new_group=null,e.ui_cardouttemp=null,e.ui_shareCom=null,e.ui_btn_facebook=null,e.ui_btn_wechat=null,e.ui_withdrawcom=null,e.ui_btn_withdraw=null,e.addCash=null,e.tipsTimes=0,e.playerCount=0,e.gameCount=0,e.animationPlayOver=!1,e.mopaiNow=!1,e.hasMopai=!1,e.fromMopai=0,e.currentPoker=null,e.dapaiCount=0,e.sendCardData={},e.addNewGroupBool=!1,e.groupSpacing=100,e.cardSpacing=95,e.cardSpacing2=95,e.startPos=320,e.startPos2=320,e._first_group=!1,e._second_group=!1,e.allPoints=0,e.groupType=[],e.groupTypePoints=[],e.effectiveGroup=0,e.needLife=0,e.isZahu=!1,e.isCanHupai=!1,e.isMeHupai=!1,e.otherHupai=!1,e.fisrtHuPos=0,e.requesting=!1,e.myGold=0,e.islevel=!1,e.isExit=!1,e.gift=null,e.ui_chat0=null,e.ui_chat1=null,e.ui_chat2=null,e.ui_chat3=null,e.ui_chat4=null,e.ui_chat5=null,e.ready=!0,e.isleven=!1,e.titlePool=[],e}return o(e,t),Object.defineProperty(e.prototype,"packageResourceName",{get:function(){return"rummy"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packageName",{get:function(){return"res/rummy"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentName",{get:function(){return"rummy"},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.controller=k.default.instance,this.controller.view=this,fgui.GRoot.create(),fgui.UIObjectFactory.setExtension("ui://rummy/player",x.default),fgui.UIObjectFactory.setExtension("ui://rummy/poker",I.default),fgui.UIObjectFactory.setExtension("ui://rummy/groupPoker",S.default),fgui.UIObjectFactory.setExtension("ui://rummy/resout_item",O.default),this.loadSoundResources(),t.prototype.onLoad.call(this)},e.prototype.createChildComponents=function(){t.prototype.createChildComponents.call(this),fgui.GRoot.inst.addChild(this.fguiComponent),this.fguiComponent.makeFullScreen(),this.chatView=this.addFguiComponent(v.default,!0),this.chatView.sendChatMsg=this.sendChatMsg.bind(this),this.chatView.IsInput=!1,this.gift=this.addFguiComponent(P.default),this.resoutPanel=this.addFguiComponent(A.default,!0),this.finishView=this.addFguiComponent(R.default,!0),this.addFguiComponent(p.default,!0),this.initUI(),this.fguiComponent.getChild("n91").visible=!(g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide),"2"==g.AppConst.languageType&&this.setLanguage()},e.prototype.selectLanguage=function(){var t,e;this.setLanguage(),this.resoutPanel.setLanguage(),this.helpInfo&&this.helpInfo.setLanguage(),this.finishView&&this.finishView.setLanguage(),null===(t=c.CommonCtr.instance.view)||void 0===t||t.setLanguage(),null===(e=this.addCash)||void 0===e||e.setLanguage()},e.prototype.setLanguage=function(){for(var t="1"==g.AppConst.languageType?"english":"hindi",e=18;e<44;e++){var i=xgameTable.getComplanguageRummyById(e);i&&i.comp&&this[i.comp]&&(1==i.type?"ui_rummyBet"==i.comp||"ui_closeNum"==i.comp||"ui_openNum"==i.comp?this[i.comp].setVar("base",i[t]).flushVars():this[i.comp].text=i[t]:this[i.comp].url=i[t])}this.ui_pokerDropMask.visible&&(this.ui_nomoney.visible?this.setNoMoneyBtn(!1):this.setNoMoneyBtn(!0))},e.prototype.sendEnterTable=function(){this.controller.cs_entertable_rummy()},e.prototype.allChildCreated=function(){t.prototype.allChildCreated.call(this),h.BaseFrameNative.nowGameView=this,h.BaseFrameNative.isInHall=!1,cc.game.off(cc.game.EVENT_SHOW),cc.game.on(cc.game.EVENT_SHOW,this.gameEventShow.bind(this)),cc.game.off(cc.game.EVENT_HIDE),cc.game.on(cc.game.EVENT_HIDE,this.gameEventHide.bind(this)),this.sendEnterTable()},e.prototype.loadSoundResources=function(){cc.assetManager.getBundle(this.packageResourceName).loadDir("res/Sounds",cc.AudioClip,function(t,e){if(!t)for(var i=l.AudioManager.Singleton,s=0;s<e.length;s++)i.add(e[s].name,e[s])})},e.prototype.gameEventShow=function(){var t=this;cc.game.resume(),this.scheduleOnce(function(){t.sendReconnect()},.5)},e.prototype.sendReconnect=function(){m.ReconnectManager.getInstance.reconnect(this.connectSuccess.bind(this),this.connectFail.bind(this))},e.prototype.connectSuccess=function(){var t=this;cc.isValid(this.node)&&this.scheduleOnce(function(){t.controller.cs_entertable_rummy()},1)},e.prototype.connectFail=function(t){var e=this;c.CommonCtr.instance.ShowTipCallback(t,function(){e.sendReconnect()})},e.prototype.gameEventHide=function(){this&&this.players&&this.players.forEach(function(t){!t.seatEmpty&&t.stopTween()}),cc.game.pause()},e.prototype.initUI=function(){this.ui_btn_facebook.visible=!1;for(var t=0;t<6;t++)this.players[t]=this.ui_centercom.getChild("player"+t),this.players[t].initUiSeat(t),this.sendPokerPoint[t]=this.ui_centercom.getChild("point"+t).node.position;if(this.ui_OutCard.onClick(this.takePokerFromRight,this),this.ui_btn_pokerback.onClick(this.takePokerFromSurplus,this),this.ui_btn_exit.onClick(this.openMenu,this),this.ui_btn_discard.onClick(this.outPoker,this),this.ui_btn_group.onClick(this.spliceGroup,this),this.ui_btn_drop.onClick(this.surrender,this),this.ui_btn_sort.onClick(this.startSortPoker,this),this.ui_btn_prepare.onClick(this.prepare,this),this.ui_btn_declare.onClick(this.hupai,this),this.ui_btn_outlog.onClick(this.outPokerLog,this),this.ui_btn_toHall.onClick(this.exitGame,this),this.ui_btn_setting.onClick(this.setSound,this),this.ui_setClick.onClick(this.openMenu,this),this.ui_btn_help.onClick(this.showHelp,this),this.ui_btn_switchtable.onClick(this.switchtable,this),this.startEff=this.ui_centercom.getTransition("t0"),this.xipaiEff=this.ui_centercom.getTransition("t2"),this.tipsControlle=this.ui_myTips.getController("c1"),this.ui_btn_transposition.onClick(this.switchtable1,this),this.ui_btn_finish.onClick(this.finishCard,this),this.ui_btn_addcash.onClick(this.showAddCash,this),this.ui_btn_view.onClick(this.showResout,this),g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide)for(this.ui_btn_pokerback.getChildAt(0).asLoader.url="ui://rummy/cards18_2",this.ui_cardStart.getChildAt(0).asLoader.url="ui://rummy/cards18_2",this.ui_cardouttemp.getChildAt(0).asLoader.url="ui://rummy/cards18_2",t=0;t<this.ui_cardEff.numChildren;t++)this.ui_cardEff.getChildAt(t).asButton.getChildAt(0).asLoader.url="ui://rummy/cards18_2";else this.ui_btn_addcash.visible=!0;this.initResolution(),this.ui_btn_facebook.onClick(this.shareFacebook,this),this.ui_btn_wechat.onClick(this.shareWechat,this),this.ui_withdrawcom.sortingOrder=100,this.ui_btn_withdraw.onClick(this.towithdraw,this)},e.prototype.towithdraw=function(){this.controller.Model.goHall=!0,g.AppConst.isWithdr=!0,this.gotoHall()},e.prototype.showShare=function(){this.ui_pokerDropMask.visible=!0,this.ui_cardTimeOut.visible=!1,this.ui_nomoney.visible=!1,this.ui_shareCom.visible=!0,this.setNoMoneyBtn(!0)},e.prototype.shareFacebook=function(){_.default.Singleton.report("game_share_click_share"),g.AppConst.mPlayerModel.ShareCount+=1,this.controller.cs_sharerewards(),_.default.Singleton.report("game_share_share_success"),d.MgrNative.getInstance().copyUserId(g.AppConst.inviteData.code,g.AppConst.mPlayerModel.userid,"\ud83d\udcb5Play Teen Patti and win Real Cash!\ud83d\udcb5\n\ud83d\udd25Install and got bonus + R$50\ud83d\udd25\n\ud83d\udcb0Daily winnings up to R$ 7 Lakhs\ud83d\udcb0\n\ud83d\ude0dSuper fast cash withdraw\ud83d\ude0d\n\ud83d\udc47\ud83d\udc47\ud83d\udc47"),d.MgrNative.getInstance().showWhatsAppService()},e.prototype.shareWechat=function(){_.default.Singleton.report("game_share_click_share"),g.AppConst.mPlayerModel.ShareCount+=1,this.controller.cs_sharerewards(),_.default.Singleton.report("game_share_share_success"),d.MgrNative.getInstance().copyUserId(g.AppConst.inviteData.code,g.AppConst.mPlayerModel.userid,"\ud83d\udcb5Play Teen Patti and win Real Cash!\ud83d\udcb5\n\ud83d\udd25Install and got bonus + R$50\ud83d\udd25\n\ud83d\udcb0Daily winnings up to R$ 7 Lakhs\ud83d\udcb0\n\ud83d\ude0dSuper fast cash withdraw\ud83d\ude0d\n\ud83d\udc47\ud83d\udc47\ud83d\udc47"),d.MgrNative.getInstance().showWhatsAppService()},e.prototype.showAddCash=function(){this.addCash?this.addCash.Show():this.addCash=this.addFguiComponent(w.default),this.addCash.init(this.controller.Model.tableid,this.myGold)},e.prototype.gameStartTimes=function(){var t=2==this.controller.Model.gameType;this.players[1].visible=!t,this.players[2].visible=!t,this.players[4].visible=!t,this.players[5].visible=!t,this.ui_statrWaitone.visible=!1,this.ui_statrWait.visible=!0,this.tipsTimes=3,this.ui_waittimeer.text="3",this.ui_statrWait.getTransition("t0").play(),this.unschedule(this.startGameTimes),this.schedule(this.startGameTimes,1,2)},e.prototype.startGameTimes=function(){this.tipsTimes-=1,this.ui_waittimeer.text=this.tipsTimes+"",3==this.tipsTimes||this.tipsTimes<=0&&(this.ui_statrWait.visible=!1)},e.prototype.showPlayerByTime=function(t){var e=this;this.scheduleOnce(function(){e.addNewPlayer(t)},+(3*Math.random()).toFixed(1))},e.prototype.showWait=function(t,e,i){if(e){if(this.ui_statrWaitone.visible)return;this.ui_viewcom.visible=!1,this.ui_statrWait.visible=t,this.ui_statrWait.getController("c1").setSelectedIndex(e?0:1),this.tipsTimes=i,this.ui_waittimeer.text=i+"",this.ui_statrWait.getTransition("t0").play(),this.unschedule(this.startGameTimes),this.schedule(this.startGameTimes,1,i-1)}else this.ui_viewcom.visible=!0;if(0==this.ready&&0==this.gameState){if(this.ui_pokerDropMask.visible&&this.ui_nomoney.visible)return;this.controller.cs_ready_rummy()}},e.prototype.showWaitTimes=function(){this.ui_viewcom.visible=!1,this.ui_statrWait.visible=!0,this.ui_statrWait.getController("c1").setSelectedIndex(0),this.tipsTimes=4,this.ui_waittimeer.text="4",this.ui_statrWait.getTransition("t0").play(),this.unschedule(this.startGameTimes),this.schedule(this.startGameTimes,1,3)},e.prototype.showResout=function(){this.ui_viewcom.visible=!1,this.resoutPanel.Show()},e.prototype.showTips=function(t,e,i){if(void 0===i&&(i=1),!t)return this.ui_myTips.visible=!1,void this.unschedule(this.startTipTimes);this.tipsControlle.setSelectedIndex(i),this.ui_myTips.visible=!0,this.ui_tipstitle.text=t,e>0&&(this.tipsTimes=e,this.ui_tipstimes.text=this.tipsTimes+"",this.unschedule(this.startTipTimes),this.schedule(this.startTipTimes,1,e-1))},e.prototype.startTipTimes=function(){this.tipsTimes-=1,1==this.tipsTimes&&this.hupai(null),this.tipsTimes<0||(this.ui_tipstimes.text=this.tipsTimes+"")},e.prototype.addNewPlayer=function(t){var e=this.transformationPos(t.tpos);this.players[e].initData(t)},e.prototype.transformationPos=function(t){if(2==this.controller.Model.gameType)return t==this.controller.Model.myPos?0:3;var e=t-this.controller.Model.myPos;return e<0&&(e=6+e),e>5&&(e=0),e},e.prototype.playerInfo=function(t){var e=this.transformationPos(t);return[this.players[e].headId,this.players[e].nickName]},e.prototype.getPlayerPos=function(t){for(var e=0;e<6;e++)if(!this.players[e].seatEmpty&&this.players[e].userid==t)return this.players[e].pos},e.prototype.gameStart=function(){return n(this,void 0,void 0,function(){var t,e,i,s,o=this;return a(this,function(r){switch(r.label){case 0:return this.clean(),this.gameCount+=1,this.gameCount<=10&&_.default.Singleton.report("Game_level_"+this.gameCount),this.ui_viewcom.visible=!1,this.fisrtHuPos=0,g.AppConst.isGoldCosted=!0,this.animationPlayOver=!1,this.ui_statrWait.visible=!1,this.ui_statrWaitone.visible=!1,this.gameState=1,this.ui_cardEff.x=1095,this.ui_cardEff.visible=!0,this.ui_finishbg.visible=!0,this.ui_finish.visible=!0,this.resoutPanel.cleanList(),this.mopaiNow=!1,this.dapaiCount=0,this.isZahu=!1,this.ui_btn_drop.title=-20*this.controller.Model.baserate+"",[4,this.sendPokerDing()];case 1:return r.sent(),l.AudioManager.Singleton.play("","rummyDeal"),this.recoveryPoker(),t=this.controller.Model.tablestartData,this.commonPoker2=t.WildCard,16==t.WildCard||17==t.WildCard?this.commonPoker=214:this.commonPoker=t.WildCard,[4,this.sendPoker()];case 2:for(r.sent(),this.isMeHupai=!1,this.controller.Model.selectCard.length=0,this.myPokers.length>0&&(this.startSortPoker(null),this.ui_btn_sort.visible=!0),e=0;e<t._pos2id.length;e++)i=this.transformationPos(t._pos2id[e].pos),this.players[i].userid!=t._pos2id[e].val&&this.players[i].exit();return s=this.transformationPos(t.BPos),this.giveupPoker.push(t.dipai),this.ui_LeprosyCard.url=this.pokerResStart+t.WildCard,this.ui_btn_pokerback.visible=!0,this.startEff.play(function(){o.ui_closeNum.visible=!0,o.ui_openNum.visible=!0,o.closeNum=t._leftmj-1,o.ui_closeNum.setVar("num",o.closeNum+"").flushVars(),o.ui_openNum.setVar("num","1").flushVars(),o.ui_OutCard.url=o.pokerResStart+t.dipai,16==t.dipai||17==t.dipai||t.dipai%100==o.commonPoker%100?o.ui_OutCard.color=cc.Color.set(o.outPokerColor,255,232,127):o.ui_OutCard.color=cc.Color.set(o.outPokerColor,255,255,255),o.ui_btn_outlog.visible=!0,t.BPos==o.controller.Model.myPos&&(o.ui_btn_drop.visible=!0,o.showArrow(!0),o.scheduleOnce(o.showPickTip,5)),o.players[s].getDrop()||o.players[s].startOpt(),o.animationPlayOver=!0},1),[2]}})})},e.prototype.advancePlayOver=function(){var t=this;return new Promise(function(e){t.unscheduleAllCallbacks(),t.recoveryPoker();var i=t.controller.Model.tablestartData;if(i)t.commonPoker2=i.WildCard,16==i.WildCard||17==i.WildCard?t.commonPoker=214:t.commonPoker=i.WildCard;else{var s=t.controller.Model.entertable._recover;t.commonPoker2=s.wildCard,16==s.wildCard||17==s.wildCard?t.commonPoker=214:t.commonPoker=s.wildCard}t.myCards.length=0,t.sortCards[0]=[],t.myPokers.length=0;for(var o=0;o<i._pos2tile.length;o++)if(i._pos2tile[o].pos==t.controller.Model.myPos&&t.mySitDown)for(var r=0;r<i._pos2tile[o].vallist.length;r++){var n=t.createPoker();t.myPokers[r]=n,t.myCards[r]=i._pos2tile[o].vallist[r],t.sortCards[0][r]=i._pos2tile[o].vallist[r],t.ui_pokerNode.addChild(n),n.node.y=-760,n.setData(i._pos2tile[o].vallist[r],!0)}t.isMeHupai=!1,t.ui_btn_sort.visible=!0,t.controller.Model.selectCard.length=0,t.startSortPoker(null),t.giveupPoker.length=0,t.giveupPoker.push(i.dipai),t.ui_LeprosyCard.url=t.pokerResStart+i.WildCard,t.startEff.timeScale=5,t.startEff.play(function(){t.startEff.timeScale=1,t.ui_closeNum.visible=!0,t.ui_openNum.visible=!0,t.closeNum=i._leftmj-1,t.ui_closeNum.setVar("num",t.closeNum+"").flushVars(),t.ui_openNum.setVar("num","1").flushVars(),t.ui_OutCard.url=t.pokerResStart+i.dipai,16==i.dipai||17==i.dipai||i.dipai%100==t.commonPoker%100?t.ui_OutCard.color=cc.Color.set(t.outPokerColor,255,232,127):t.ui_OutCard.color=cc.Color.set(t.outPokerColor,255,255,255),t.ui_btn_outlog.visible=!0,e(!0)},1)})},e.prototype.sendPokerDing=function(){var t=this;return new Promise(function(e){var i=t.controller.Model.tablestartData;t.controller.Model.nowTokenPos=i.BPos;for(var s=t.transformationPos(i.BPos),o=function(o){var r=t.transformationPos(i.dices[o].pos),n=t.createPoker();t.ui_pokerNode.addChild(n),n.node.scale=.6,n.node.setPosition(t.ui_cardStart.node.position),n.setData(i.dices[o].val,!1,!0),n.node.runAction(cc.sequence(cc.moveTo(.05+.1*o,t.sendPokerPoint[r].x,t.sendPokerPoint[r].y),cc.callFunc(function(){s==r&&n.showEff(),o==i.dices.length-1&&(t.players[s].setZhuang(),t.scheduleOnce(function(){e(!0)},2))})))},r=0;r<i.dices.length;r++)o(r)})},e.prototype.sendPoker=function(){var t=this;return new Promise(function(e){t.myCards.length=0,t.sortCards[0]=[],t.myPokers.length=0;for(var i=t.controller.Model.tablestartData,s=function(s){if(i._pos2tile[s].pos==t.controller.Model.myPos&&t.mySitDown){if(0==i._pos2tile[s].vallist.length)return e(!0),{value:void 0};l.AudioManager.Singleton.play("","rummyDealFlip");for(var o=[],r=0,n=i._pos2tile[s].vallist.length;r<n;r++){var a=t.createPoker();a.setData(18,!1),a.node.scale=.8,a.node.setPosition(t.ui_cardStart.node.position),t.ui_pokerNode.addChild(a),o.push(a)}var u=function(r){var n=o.pop();t.myPokers[r]=n,t.myCards[r]=i._pos2tile[s].vallist[r],t.sortCards[0][r]=i._pos2tile[s].vallist[r],0==r&&t.scheduleOnce(function(){l.AudioManager.Singleton.play("","rummyJokerSelect1")},.1),n.node.runAction(cc.sequence(cc.delayTime(.25+.05*r),cc.spawn(cc.scaleTo(.1,1,1),cc.moveTo(.15,350+130*r,-760),cc.sequence(cc.delayTime(.1),cc.callFunc(function(){t.ui_pokerNode.setChildIndex(n,r)}))),cc.delayTime(.8+-.05*r),cc.scaleTo(.25,0,1),cc.callFunc(function(){n.setData(i._pos2tile[s].vallist[r],!0)}),cc.scaleTo(.2,1,1),cc.moveTo(.2,1160,-760),cc.delayTime(.1),cc.callFunc(function(){r==i._pos2tile[s].vallist.length-1&&e(!0)})))};for(r=0,n=i._pos2tile[s].vallist.length;r<n;r++)u(r)}},o=0;o<i._pos2tile.length;o++){var r=s(o);if("object"==typeof r)return r.value}})},e.prototype.showWaitTurn=function(){this.ui_waitTurn.visible=!1},e.prototype.takePokerFromSurplus=function(){if(0!=this.gameState&&!this.mopaiNow){if(!this.players[0].isCanOperation){if(this.myDrop||this.hasMopai)return;return this.ui_waitTurn.visible=!0,this.unschedule(this.showWaitTurn),void this.scheduleOnce(this.showWaitTurn,2)}this.mopaiNow=!0,this.players[0].isCanOperation=!1,this.fromMopai=0,this.controller.cs_mopai_rummy(0)}},e.prototype.takePokerFromRight=function(){if(0!=this.gameState&&!this.mopaiNow){if(!this.players[0].isCanOperation){if(this.myDrop||this.hasMopai)return;if(!this.ui_OutCard.url)return;return this.ui_waitTurn.visible=!0,this.unschedule(this.showWaitTurn),void this.scheduleOnce(this.showWaitTurn,2)}this.mopaiNow=!0,this.players[0].isCanOperation=!1,this.fromMopai=1,this.controller.cs_mopai_rummy(1)}},e.prototype.mopai=function(t,e){var i=this;this.mopaiNow=!1,this.unschedule(this.showPickTip),this.ui_btn_drop.visible=!1,this.ui_pickTip.visible=!1,this.showArrow(!1),this.players[0].isCanOperation=!1;var s=this.createPoker();this.ui_pokerNode.addChild(s),s.setData(t,!0),0==this.fromMopai?s.node.setPosition(this.ui_btn_pokerback.node.position.x+75,this.ui_btn_pokerback.node.position.y-105):s.node.setPosition(this.ui_OutCard.node.position.x+75,this.ui_OutCard.node.position.y-105),s.node.scale=.5,this.hasMopai=!0,this.ui_pokerNode.setChildIndex(s,20),this.myCards.push(t),this.isFinish=e,this.ui_btn_discard.visible=!1,this.myPokers.push(s);var o=Object.keys(this.sendCardData),r=this.sendCardData[o[o.length-1]][0];if(s.groupIndex=r.groupIndex,1==this.fromMopai){this.giveupPoker.pop(),this.ui_OutCard.url=this.pokerResStart+this.giveupPoker[this.giveupPoker.length-1];var n=this.giveupPoker[this.giveupPoker.length-1];16==n||17==n||n%100==this.commonPoker%100?this.ui_OutCard.color=cc.Color.set(this.outPokerColor,255,232,127):this.ui_OutCard.color=cc.Color.set(this.outPokerColor,255,255,255),this.ui_openNum.setVar("num",this.giveupPoker.length+"").flushVars()}var a=this.startPos2+13*this.cardSpacing2+(o.length-1)*this.groupSpacing;s.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,1,1),cc.moveTo(.2,a,-760)),cc.callFunc(function(){1==i.fromMopai||(i.closeNum--,i.closeNum<0&&(i.closeNum=0),0==i.closeNum&&(i.ui_btn_pokerback.visible=!1,i.ui_cardEff.visible=!1),i.ui_closeNum.setVar("num",i.closeNum+"").flushVars()),i.arrangementPoint()})))},e.prototype.noticeSomeMopai=function(t){var e;return n(this,void 0,void 0,function(){var i,s,o,r=this;return a(this,function(n){switch(n.label){case 0:return this.animationPlayOver?[3,2]:(this.animationPlayOver=!0,[4,this.advancePlayOver()]);case 1:n.sent(),n.label=2;case 2:return l.AudioManager.Singleton.play("","rummyCardSlide"),1==t.cardPos&&this.ui_outPokerPanel.visible&&this.ui_outPokerList.removeChildToPoolAt(0),null===(e=c.CommonCtr.instance.view)||void 0===e||e.Hide(),this.controller.Model.nowTokenPos=t._pos,t._pos!=this.controller.Model.myPos&&(i=this.transformationPos(t._pos),s=this.createPoker(),this.ui_pokerNode.addChild(s),1==t.cardPos?(s.setData(this.giveupPoker[this.giveupPoker.length-1],!1),s.node.setPosition(this.ui_OutCard.node.position.x+75,this.ui_OutCard.node.position.y-105)):(this.closeNum--,this.closeNum<0&&(this.closeNum=0),this.ui_closeNum.setVar("num",this.closeNum+"").flushVars(),s.setData(18,!1),s.node.setPosition(this.ui_btn_pokerback.node.position.x+75,this.ui_btn_pokerback.node.position.y-105)),s.node.scale=.7,1==t.cardPos&&(this.giveupPoker.pop(),this.ui_openNum.setVar("num",this.giveupPoker.length+"").flushVars(),this.ui_OutCard.url=this.pokerResStart+this.giveupPoker[this.giveupPoker.length-1],16==(o=this.giveupPoker[this.giveupPoker.length-1])||17==o||o%100==this.commonPoker%100?this.ui_OutCard.color=cc.Color.set(this.outPokerColor,255,232,127):this.ui_OutCard.color=cc.Color.set(this.outPokerColor,255,255,255)),s.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,.6,.6),cc.moveTo(.25,this.players[i].node.x,this.players[i].node.y)),cc.callFunc(function(){r.ui_pokerNode.removeChild(s),r.addPoker(s)})))),0==this.closeNum&&(this.ui_btn_pokerback.visible=!1,this.ui_cardEff.visible=!1),[2]}})})},e.prototype.setCurrentPoker=function(t){this.currentPoker=t},e.prototype.outPoker=function(){if(this.hasMopai&&this.currentPoker){this.hasMopai=!1;var t=this.currentPoker.sid;this.controller.cs_dapai_rummy(t,this.sortCards)}},e.prototype.playDelPoker=function(t){var e=this;l.AudioManager.Singleton.play("","rummyPickDiscard"),this.controller.Model.nowTokenPos=t._nextPos;var i=this.transformationPos(t._pos);if(this.players[i].stopTime(),this.ui_btn_finish.visible=!1,this.ui_btn_drop.title=-t.dropTimes*this.controller.Model.baserate+"",this.ui_outPokerPanel.visible){var s=this.ui_outPokerList.getFromPool();s.getChild("outPokerItem").asLoader.url=this.pokerResStart+t._card,this.ui_outPokerList.addChildAt(s,0)}if(t._pos==this.controller.Model.myPos&&this.mySitDown){if(this.mopaiNow=!1,this.finishView.fguiComponent.visible=!1,this.hasMopai&&0==this.isZahu&&(this.dapaiCount+=1,this.dapaiCount<=1)){var o="1"==g.AppConst.languageType?"english":"hindi";c.CommonCtr.instance.ShowTipLabel(xgameTable.getComplanguageRummyById(49)[o])}this.hasMopai=!1;var r=-1,n=void 0;if(this.currentPoker&&this.currentPoker.sid==t._card)r=this.myPokers.indexOf(this.currentPoker),n=this.currentPoker.sid;else for(var a=0;a<this.myPokers.length;a++)this.myPokers[a].sid==t._card&&(r=a,n=this.myPokers[a].sid);if(-1!=r){this.myCards.splice(this.myCards.indexOf(n),1);var u=this.sortCards[this.myPokers[r].groupIndex];u&&u.splice(this.myCards.indexOf(n),1),T.Rummy.AddorRemoveSelect(this.myPokers[r],!1);var h=this.myPokers[r];this.myPokers.splice(r,1),this.arrangementPoint(),h.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,.8,.8),cc.moveTo(.25,this.ui_OutCard.node.position.x+75,this.ui_OutCard.node.position.y-105)),cc.callFunc(function(){e.ui_pokerNode.removeChild(h),e.addPoker(h),e.currentPoker=null,e.giveupPoker.push(t._card),e.ui_openNum.setVar("num",e.giveupPoker.length+"").flushVars(),e.ui_OutCard.url=e.pokerResStart+t._card,16==t._card||17==t._card||t._card%100==e.commonPoker%100?e.ui_OutCard.color=cc.Color.set(e.outPokerColor,255,232,127):e.ui_OutCard.color=cc.Color.set(e.outPokerColor,255,255,255),e.ExecutePlayer(t._nextPos)})))}}else{var p=this.createPoker();this.ui_pokerNode.addChild(p),p.setData(t._card,!1),p.node.setPosition(this.players[i].node.x,this.players[i].node.y),p.node.scale=.3,p.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,.8,.8),cc.moveTo(.25,this.ui_OutCard.node.position.x+75,this.ui_OutCard.node.position.y-105)),cc.callFunc(function(){e.ui_pokerNode.removeChild(p),e.addPoker(p),e.giveupPoker.push(t._card),e.ui_openNum.setVar("num",e.giveupPoker.length+"").flushVars(),e.ui_OutCard.url=e.pokerResStart+t._card,16==t._card||17==t._card||t._card%100==e.commonPoker%100?e.ui_OutCard.color=cc.Color.set(e.outPokerColor,255,232,127):e.ui_OutCard.color=cc.Color.set(e.outPokerColor,255,255,255),e.ExecutePlayer(t._nextPos)})))}},e.prototype.ExecutePlayer=function(t,e){void 0===e&&(e=25);var i=this.transformationPos(t);this.players[i].getTimeNow()||this.players[i].startOpt(e),t==this.controller.Model.myPos&&this.mySitDown?(l.AudioManager.Singleton.play("","your_turn"),e>5&&this.scheduleOnce(this.showPickTip,5),this.showArrow(!0),this.ui_btn_declare.visible=!1,this.ui_btn_drop.visible=this.myCards.length<=13,this.ui_btn_group.visible=!1,this.ui_btn_discard.visible=!1,this.controller.Model.selectCard.length>1&&(this.ui_btn_group.visible=!0)):(this.ui_btn_drop.visible=!1,this.ui_btn_declare.visible=!1,this.ui_btn_discard.visible=!1)},e.prototype.spliceGroup=function(){var t=this.controller.Model.selectCard;if(!(t.length<2)){var e=!1;if(t.length>1){for(var i=0;i<t.length;i++)if(1==this.sendCardData[t[i].groupIndex].length){e=!0;break}var s=Object.keys(this.sendCardData).length;s<6&&s>0&&(e=!0)}if(e){l.AudioManager.Singleton.play("","rummyGroup"),this.ui_btn_group.visible=!1;for(var o=0;o<this.myPokers.length;o++)this.myPokers[o].groupIndex=this.myPokers[o].groupIndex+1;this.controller.Model.selectCard.forEach(function(t){t.groupIndex=0,t.select=!1}),this.arrangementPoint()}else{var r="1"==g.AppConst.languageType?"english":"hindi";c.CommonCtr.instance.ShowTipLabel(xgameTable.getComplanguageRummyById(48)[r])}}},e.prototype.addNewGroup=function(t){if(!this.addNewGroupBool)if(this.addNewGroupBool=!0,Object.keys(this.sendCardData).length>=6)this.arrangementPoint();else{var e=Object.keys(this.sendCardData);t.groupIndex=this.sendCardData[e[e.length-1]][0].groupIndex+1,this.arrangementPoint()}},e.prototype.initResolution=function(){var t=cc.winSize.width/1920;t>1&&(this.cardSpacing=Math.floor(this.cardSpacing*t),this.startPos=Math.floor(this.startPos-this.startPos*(t-1)))},e.prototype.arrangementPoint=function(){this.sendCardData=null,this.sendCardData={},this.ui_btn_group.visible=!1;for(var t=0;t<this.myPokers.length;t++)this.ui_pokerNode.setChildIndex(this.myPokers[t],t),this.myPokers[t].select=!1,this.sendCardData[this.myPokers[t].groupIndex]||(this.sendCardData[this.myPokers[t].groupIndex]=[]),this.sendCardData[this.myPokers[t].groupIndex].push(this.myPokers[t]);var e=this.startPos,i=this.cardSpacing,s=Object.keys(this.sendCardData).length;95==this.cardSpacing?i=s<=3?115:4==s?105:5==s?100:93:this.cardSpacing>95&&(e-=s<=4?10:5==s?20:30),this.startPos2=e,this.cardSpacing2=i,this.sortCards=[],this.recoveryTitle();var o=0,r=this.wildPokerSid();for(var n in this.groupType.length=0,this.groupTypePoints.length=0,this.sendCardData){var a=this.createGroupTitle();this.ui_groupNode.addChild(a),this.sortCards[o]=[],a.x=e-95,a.y=832,a.width=194*this.sendCardData[n].length-(this.sendCardData[n].length-1)*(194-i);var l=T.Rummy.GetRummyTypeWild(this.getPokerSid(this.sendCardData[n]),r),u=this.checkPokerPoints(this.sendCardData[n]);for(this.groupType[o]=l,this.groupTypePoints[o]=u,t=0;t<this.sendCardData[n].length;t++)this.sendCardData[n][t].node.x=e,this.sendCardData[n][t].node.y=-760,e+=i,this.sortCards[o][t]=this.sendCardData[n][t].sid;e+=this.groupSpacing,o++}this.controller.Model.selectCard.length=0,this.checkGroupType(),this.ui_allPoints.text=(this.allPoints>80?80:this.allPoints)+"",this.otherHupai&&this.ui_myTips.visible&&this.controller.cs_makecard_rummy(this.sortCards)},e.prototype.checkGroupType=function(){this.allPoints=0;var t,e=-1;this._first_group=!1,this._second_group=!1,this.needLife=0;var i=0;t=this.groupType.lastIndexOf(14);for(var s=0;s<this.groupType.length;s++)-1!=t&&this.groupType[s]>2&&s!=t&&(e=s);var o="1"==g.AppConst.languageType?"english":"hindi";for(-1!=t&&((r=this.ui_groupNode.getChildAt(t)).setColor(0),r.setTitle(xgameTable.getComplanguageRummyById(51)[o]),this._first_group=!0,i+=1),-1!=e&&((r=this.ui_groupNode.getChildAt(e)).setColor(0),r.setTitle(xgameTable.getComplanguageRummyById(52)[o]),this._second_group=!0,i+=1),s=0;s<this.groupType.length;s++){var r;s!=t&&s!=e&&((r=this.ui_groupNode.getChildAt(s)).initData(this.groupType[s],this.groupTypePoints[s]),-1==t&&-1==e&&this.groupType[s]>2?(r.setTitle(xgameTable.getComplanguageRummyById(58)[o]),r.setColor(3),this.needLife=1):-1==t||-1!=e||1!=this.groupType[s]&&2!=this.groupType[s]?-1!=t||-1!=e||1!=this.groupType[s]&&2!=this.groupType[s]?-1!=t&&-1!=e&&this.groupType[s]>0&&(i+=1):(r.setTitle(xgameTable.getComplanguageRummyById(58)[o]),r.setColor(3)):(r.setTitle(xgameTable.getComplanguageRummyById(59)[o]),r.setColor(3),this.needLife=2))}if(i>this.effectiveGroup){s=0;for(var n=i-this.effectiveGroup;s<n;s++)l.AudioManager.Singleton.play("","rummyPositiveGroup")}this.effectiveGroup=i},e.prototype.getPokerSid=function(t){var e=[];return t.forEach(function(t){e.push(t.sid)}),e},e.prototype.wildPokerSid=function(){var t=this.commonPoker%100;return[16,17,100+t,200+t,300+t,400+t]},e.prototype.checkPokerPoints=function(t){for(var e=0,i=this.commonPoker%100,s=0;s<t.length;s++){var o=t[s].points;16==o||17==o||o==i||(e+=o>10?10:o)}return e},e.prototype.moveEnd=function(t){if(!this.addNewGroupBool){this.myPokers=this.myPokers.sort(function(t,e){return t.node.x-e.node.x}),t.select=!1;for(var e=0;e<this.myPokers.length;e++)if(this.myPokers[e]==t){var i=this.myPokers[e-1],s=this.myPokers[e+1];i&&s?i.groupIndex==s.groupIndex?this.myPokers[e].groupIndex=i.groupIndex:t.node.x-i.node.x<s.node.x-t.node.x?this.myPokers[e].groupIndex=i.groupIndex:this.myPokers[e].groupIndex=s.groupIndex:this.myPokers[e].groupIndex=i&&!s?i.groupIndex:s.groupIndex}this.ui_btn_finish.visible=!1,this.ui_btn_discard.visible=!1,this.otherHupai||(this.ui_btn_declare.visible=!1),this.arrangementPoint()}},e.prototype.GroupBtn=function(t){this.isCanHupai=!1;var e=this.controller.Model.selectCard;if(0==e.length)return this.ui_btn_discard.visible=!1,this.ui_btn_finish.visible=!1,void(this.otherHupai||(this.ui_btn_declare.visible=!1));if(this.ui_btn_group.visible=e.length>1,1==e.length&&!this.hasMopai)return this.ui_btn_discard.visible=!1,void(this.ui_btn_finish.visible=!1);if(1==e.length&&(this.ui_btn_finish.visible=!0),e.length>1||this.otherHupai)return this.ui_btn_discard.visible=!1,void(this.ui_btn_finish.visible=!1);var i=0,s=0,o=-1,r=this.wildPokerSid(),n=0;for(var a in this.sendCardData){var l=this.ui_groupNode.getChildAt(i).getColor();1==l?s+=1:3==l&&(n+=1),t.groupIndex==+a&&(o=l),i++}var u,h=this.getPokerSid(this.sendCardData[t.groupIndex]);1==h.length?u=1:(h.splice(h.indexOf(t.sid),1),u=T.Rummy.GetRummyTypeWild(h,r));var c=Object.keys(this.sendCardData);if(n!=c.length||1!=this.needLife)if(n<c.length&&n>0&&0==s)u>2?(this.setBtnDisOrDec(!0),this.isCanHupai=!0):this.setBtnDisOrDec(!1);else if(0==s)u>0?(this.setBtnDisOrDec(!0),this.isCanHupai=!0):this.setBtnDisOrDec(!1);else if(1==s)if(1!=o)this.setBtnDisOrDec(!1);else{if(n>0)return void(1==this.needLife?14==u?(this.setBtnDisOrDec(!0),this.isCanHupai=!0):this.setBtnDisOrDec(!1):2==this.needLife?u>2?(this.setBtnDisOrDec(!0),this.isCanHupai=!0):this.setBtnDisOrDec(!1):u>0?(this.setBtnDisOrDec(!0),this.isCanHupai=!0):this.setBtnDisOrDec(!1));u>0?(this.setBtnDisOrDec(!0),this.isCanHupai=!0):this.setBtnDisOrDec(!1)}else this.setBtnDisOrDec(!1);else 14==u?(this.setBtnDisOrDec(!0),this.isCanHupai=!0):this.setBtnDisOrDec(!1)},e.prototype.setBtnDisOrDec=function(t){this.ui_btn_declare.visible=t,this.ui_btn_discard.visible=!t},e.prototype.startSortPoker=function(t,e){void 0===e&&(e=null),l.AudioManager.Singleton.play("","rummy_swipe"),null!=e&&e.length>0?this.sortCards=e:this.sortCards=T.Rummy.GroupSort(this.myCards,this.commonPoker);for(var i=0,s=0;s<this.sortCards.length;s++)for(var o=0;this.sortCards[s]&&o<this.sortCards[s].length;o++)this.myPokers[i].setData(this.sortCards[s][o],!0),this.myPokers[i].groupIndex=s,this.ui_pokerNode.setChildIndex(this.myPokers[i],i),this.myCards[i]=this.sortCards[s][o],i++;this.currentPoker=null,this.ui_btn_finish.visible=!1,this.ui_btn_discard.visible=!1,this.arrangementPoint()},e.prototype.finishCard=function(){var t=this;if(this.currentPoker)if(this.hasMopai||13!=this.myPokers.length){if(this.controller.Model.nowTokenPos!=this.controller.Model.myPos)return this.ui_btn_declare.visible=!1,this.ui_btn_discard.visible=!1,this.ui_btn_finish.visible=!1,void this.arrangementPoint();if(this.isCanHupai){var e=0;for(var i in this.sendCardData){if(this.currentPoker.groupIndex==+i)break;e++}return 1==this.sortCards[e].length?this.sortCards.splice(e,1):this.sortCards[e].splice(this.sortCards[e].indexOf(this.currentPoker.sid),1),this.isMeHupai=!0,this.gameState=0,void this.controller.cs_finish_rummy(this.sortCards,!0,this.currentPoker.sid)}this.finishView.addFunction(function(){var e=0;for(var i in t.sendCardData){if(t.currentPoker.groupIndex==+i)break;e++}t.isCanHupai||(t.isZahu=!0),1==t.sortCards[e].length?t.sortCards.splice(e,1):t.sortCards[e].splice(t.sortCards[e].indexOf(t.currentPoker.sid),1),t.controller.cs_finish_rummy(t.sortCards,!0,t.currentPoker.sid)},function(){t.arrangementPoint(),t.ui_btn_discard.visible=!1,t.ui_btn_finish.visible=!1}),this.finishView.Show(),this.finishView.setTips(1)}else this.arrangementPoint()},e.prototype.hupai=function(){if(this.ui_btn_declare.visible=!1,this.ui_btn_drop.visible=!1,this.ui_btn_sort.visible=!1,this.ui_btn_group.visible=!1,this.gameState=0,this.otherHupai)this.controller.cs_finish_rummy(this.sortCards,!1);else{this.isMeHupai=!0;var t=0;for(var e in this.sendCardData){if(this.currentPoker.groupIndex==+e)break;t++}1==this.sortCards[t].length?this.sortCards.splice(t,1):this.sortCards[t].splice(this.sortCards[t].indexOf(this.currentPoker.sid),1),this.controller.cs_finish_rummy(this.sortCards,!0,this.currentPoker.sid)}},e.prototype.setbtn_declare=function(){var t=this;this.ui_btn_declare.visible=!1,this.ui_btn_drop.visible=!1,this.ui_btn_finish.visible=!1,this.ui_btn_sort.visible=!1,this.isMeHupai?(this.players[0].stopTime(),this.scheduleOnce(function(){t.resoutPanel.Show()},.5)):(this.showTips("",0),this.resoutPanel.Show());for(var e=0;e<this.myPokers.length;e++)this.myPokers[e].cleanEvent()},e.prototype.sc_startfinish_rummy_n=function(t){var e=this,i=(t.score>80?80:t.score)*this.controller.Model.baserate*100;if(t.bStart){this.ui_btn_drop.visible=!1;for(var s="",o=void 0,r=0;r<6;r++)if(!this.players[r].seatEmpty&&this.players[r].userid==t.hupos){s=this.players[r].getUserName(),o=this.players[r].pos,this.fisrtHuPos=o;break}var n,a=this.transformationPos(o);if(this.players[a].stopTime(),o==this.controller.Model.myPos)if(l.AudioManager.Singleton.play("","rummyWin"),this.currentPoker&&this.currentPoker.sid==t.card)n=this.currentPoker;else for(r=0;r<this.myPokers.length;r++)this.myPokers[r].sid==t.card&&(n=this.myPokers[r]);else{n=this.createPoker(),this.ui_pokerNode.addChild(n),n.setData(t.card,!1),n.node.setPosition(this.players[a].node.x,this.players[a].node.y),n.node.scale=.3,this.myCards.length>0&&!this.myDrop&&(this.ui_btn_declare.visible=!0),this.otherHupai=!0;var u="1"==g.AppConst.languageType?"english":"hindi";this.showTips("[color=#FFD422]"+s+"[/color] "+xgameTable.getComplanguageRummyById(57)[u],t.time,1)}if(n){if(o==this.controller.Model.myPos){if(14==this.myPokers.length){var h=-1;for(r=0;r<this.myPokers.length;r++)if(this.myPokers[r]==this.currentPoker){h=r;break}this.myPokers.splice(h,1)}this.arrangementPoint()}n.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,.8,.8),cc.moveTo(.25,this.ui_finishCard.node.position.x+75,this.ui_finishCard.node.position.y-105)),cc.callFunc(function(){n.removeFromParent(),e.addPoker(n),e.ui_finishCard.url=e.pokerResStart+t.card})))}if(!(d=this.controller.Model.tablestartData))return;var c=void 0;for(0==t.hupos||(c=this.getPlayerPos(t.hupos),this.resoutPanel.oneDataAdd(t.comCards,0-i,c,5,t.score,t.hupos,t.winScore)),r=0;r<t.dropInfo.length;r++){var p=this.getPlayerPos(t.dropInfo[r].pos);this.resoutPanel.oneDataAdd([],t.dropInfo[r].val,p,2,0,t.dropInfo[r].pos,t.winScore)}}else{c=void 0;var d=this.controller.Model.tablestartData;for(r=0;r<d.dices.length;r++){var m=this.transformationPos(d.dices[r].pos);if(this.players[m].userid==t.pos){c=d.dices[r].pos;break}}this.resoutPanel.oneDataAdd(t.comCards,0-i,c,5,t.score,t.pos,t.winScore)}},e.prototype.surrender=function(){var t=this;if(!this.myDrop){var e=g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide?"":"R$:",i="1"==g.AppConst.languageType?"english":"hindi";c.CommonCtr.instance.ShowTipCallback(xgameTable.getComplanguageRummyById(45)[i]+" "+e+Math.abs(+this.ui_btn_drop.title).toFixed(2)+" "+xgameTable.getComplanguageRummyById(46)[i]+"?",function(){t.ui_btn_drop.visible=!1,t.unschedule(t.showPickTip),t.ui_pickTip.visible=!1,t.showArrow(!1),t.controller.cs_drop_rummy()},function(){})}},e.prototype.dropGold=function(){this.players[0].stopTime(),this.players[0].setDrop(),this.ui_btn_drop.visible=!1,this.ui_btn_sort.visible=!1,this.ui_btn_discard.visible=!1,this.isExit&&this.controller.cs_applyexittable_rummy()},e.prototype.sc_drop_rummy_n=function(t){if(!this.isExit)if(0!=this.gameState){var e=this.transformationPos(t._pos);if(this.players[e].stopTime(),this.players[e].setDrop(),t._pos==this.controller.Model.myPos){this.ui_lineout.visible=!1,this.ui_btn_newGroup.visible=!1,this.myDrop=!0,this.ui_btn_drop.visible=!1,this.ui_btn_sort.visible=!1,this.showArrow(!1),this.unschedule(this.showPickTip),this.ui_pickTip.visible=!1,this.arrangementPoint();for(var i=0;i<this.myPokers.length;i++)this.myPokers[i].node.y=-760,this.myPokers[i].cleanEvent();var s=this.myGold,o=s-t.punishScore<0?0:s-t.punishScore,r=g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide?"":"R$:";this.ui_coins.text=r+b.UIUtil.formatNumber100(o),this.myGold=o,t.bDrop||0==this.isZahu&&(this.ui_pokerDropMask.visible=!0,this.ui_nomoney.visible=!1,this.ui_cardTimeOut.visible=!0,this.ready=!1,this.setNoMoneyBtn(!0))}this.ExecutePlayer(t.nextPos)}else t.bDrop||t._pos!=this.controller.Model.myPos||0==this.isZahu&&(this.ready=!1,this.controller.Model.tablestartData.dices.length>2&&(this.ui_pokerDropMask.visible=!0,this.ui_nomoney.visible=!1,this.ui_cardTimeOut.visible=!0,this.setNoMoneyBtn(!0)))},e.prototype.outPokerLog=function(){this.requesting||(this.ui_outPokerPanel.visible?this.ui_outPokerPanel.visible=!1:(this.requesting=!0,this.controller.cs_getoutcard_rummy()))},e.prototype.showOutPokerPanel=function(t){this.ui_outPokerPanel.visible=!0,this.ui_outPokerList.removeChildrenToPool(),t.outCards.reverse();for(var e=0;e<t.outCards.length;e++)this.ui_outPokerList.addItemFromPool().getChild("outPokerItem").asLoader.url=this.pokerResStart+t.outCards[e]},e.prototype.setUserGold=function(t){this.myGold=t;var e=g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide?"":"R$:";if(this.ui_coins.text=e+b.UIUtil.formatNumber100(t),t<8e3*this.controller.Model.baserate)this.islevel=!0,this.ui_pokerDropMask.visible||(this.ui_pokerDropMask.visible=!0,this.ui_cardTimeOut.visible=!1,this.ui_nomoney.visible=!0,this.ready=!1,this.setNoMoneyBtn(!1));else{if(this.islevel=!1,this.ui_cardTimeOut.visible)return;this.ready=!0}},e.prototype.initSeat=function(t){this.ui_myInfo.visible=!0,this.players[0].visible=!0,this.myGold=t;var e=g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide?"":"R$:";this.ui_coins.text=e+(b.UIUtil.formatNumber100(t)||0),this.ui_allPoints.text="",this.myDrop&&this.players[0].setDrop(!0),t>=8e3*this.controller.Model.baserate&&this.ui_pokerDropMask.visible&&this.ui_nomoney.visible&&(this.ui_pokerDropMask.visible=!1,this.ui_nomoney.visible=!1)},e.prototype.setNoMoneyBtn=function(t){var e="1"==g.AppConst.languageType?"english":"hindi";t?this.ui_rummy_lab_back.text=xgameTable.getComplanguageRummyById(24)[e]:g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide?this.ui_rummy_lab_back.text=xgameTable.getComplanguageRummyById(24)[e]:this.ui_rummy_lab_back.text=xgameTable.getComplanguageRummyById(62)[e]},e.prototype.prepare=function(){this.chatView.Show()},e.prototype.setSound=function(){this.showMenu(),this.settingView?this.settingView.Show():(this.settingView=this.addFguiComponent(C.default,!0),this.settingView.selectLanguageFun=this.selectLanguage.bind(this))},e.prototype.openMenu=function(){l.AudioManager.Singleton.play("","pop_slider"),this.showMenu()},e.prototype.showMenu=function(){this.ui_menu.visible=!this.ui_menu.visible,this.ui_setClick.visible=this.ui_menu.visible},e.prototype.exitGame=function(){var t=this;if(this.controller){if(!this.controller.Model.goHall)return this.controller.Model.goHall=!0,void this.gotoHall();if(this.myDrop||1!=this.gameState)this.controller.cs_applyexittable_rummy();else{if(this.islevel)return void this.controller.cs_applyexittable_rummy();if("0"==(this.controller.Model.levelid+"").slice(-1))return this.isExit=!0,void this.controller.cs_drop_rummy();var e=g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide?"":"R$:",i="1"==g.AppConst.languageType?"english":"hindi";if(this.otherHupai&&this.ui_myTips.visible)return void c.CommonCtr.instance.ShowTipCallback(xgameTable.getComplanguageRummyById(45)[i]+" "+e+(80*this.controller.Model.baserate).toFixed(2)+" "+xgameTable.getComplanguageRummyById(46)[i]+"?",function(){t.isExit=!0,t.controller.cs_drop_rummy()},function(){});c.CommonCtr.instance.ShowTipCallback(xgameTable.getComplanguageRummyById(45)[i]+" "+e+Math.abs(+this.ui_btn_drop.title).toFixed(2)+" "+xgameTable.getComplanguageRummyById(46)[i]+"?",function(){t.isExit=!0,t.controller.cs_drop_rummy()},function(){})}}},e.prototype.showGiftPanel=function(t){if(this.gift&&this.gift.fguiComponent.visible)this.gift.fguiComponent.visible=!1;else{this.gift||(this.gift=this.addFguiComponent(P.default)),this.gift.fguiComponent&&(this.gift.fguiComponent.visible=!0),this.setGiftInfo(t.pos);var e=t.localToGlobal(),i=this.fguiComponent.globalToLocal(e.x,e.y);this.gift.fguiY=t.y+30;var s=i.x+156;s+530>this.fguiComponent.width&&(s=i.x-530),this.gift.fguiX=s}},e.prototype.clickGiftHide=function(t){t.bubbles=!1,t.stopPropagationImmediate(),this.gift.fguiComponent.visible=!1,fgui.GRoot.inst.offClick(this.clickGiftHide,this)},e.prototype.setGiftInfo=function(t){this.gift.SendChatFun=this.sendChat.bind(this),this.gift.Pos=t},e.prototype.sendChat=function(t,e){this.controller.cs_chat(e,5,t)},e.prototype.sendChatMsg=function(t,e){this.controller.cs_chat(t,e,this.controller.Model.myPos)},e.prototype.sc_chat_n=function(t){var e,i,s=this;if(5==t.type){var o=this.transformationPos(t.pos),r=this.players[o],n=this.transformationPos(t.tpos),a=this.players[n];null===(e=this.gift)||void 0===e||e.Hide(),null===(i=this.gift)||void 0===i||i.show_Gift(r.node,a.node,t.content)}else if(2==t.type)n=this.transformationPos(t.tpos),(a=this.players[n]).showEmj(t.content),this.chatView.addMsg({fromMe:0==n,content:t.content,head:a.headId,type:t.type});else if(3==t.type){var l=this.transformationPos(t.tpos);a=this.players[l],this["ui_chat"+l].getChild("chatText").asTextField.text=t.content,this["ui_chat"+l].visible=!0,this.scheduleOnce(function(){s["ui_chat"+l].visible=!1},3),this.chatView.addMsg({fromMe:0==l,content:t.content,head:a.headId,type:t.type})}},e.prototype.cleanChat=function(){for(var t=0;t<6;t++)this["ui_chat"+t].visible=!1},e.prototype.showHelp=function(){this.showMenu(),this.helpInfo?this.helpInfo.Show():this.helpInfo=this.addFguiComponent(N.default,!0)},e.prototype.showNewGroup=function(t){this.ui_btn_newGroup.visible=t},e.prototype.showArrow=function(t){this.ui_arrow1.visible=t,this.ui_arrow2.visible=t,this.ui_pokerLinght1.visible=t,this.ui_pokerLinght2.visible=t,t?(this.ui_arrow1.node.runAction(cc.repeatForever(cc.jumpBy(1,0,0,3,3))),this.ui_arrow2.node.runAction(cc.repeatForever(cc.jumpBy(1,0,0,3,3)))):(this.ui_arrow2.node.y=-262,this.ui_arrow1.node.y=-262,this.ui_arrow1.node.stopAllActions(),this.ui_arrow2.node.stopAllActions())},e.prototype.sc_token_rummy_n=function(t){return n(this,void 0,void 0,function(){var e,i;return a(this,function(s){switch(s.label){case 0:return this.animationPlayOver?[3,2]:(this.animationPlayOver=!0,[4,this.advancePlayOver()]);case 1:s.sent(),s.label=2;case 2:return e=this.transformationPos(t.pos),this.players[e].startOpt(),this.finishView.fguiComponent.visible=!1,t.pos!=this.controller.Model.myPos?(this.showArrow(!1),this.unschedule(this.showPickTip),this.ui_pickTip.visible=!1,this.ui_btn_drop.visible=!1):(l.AudioManager.Singleton.play("","your_turn"),this.showArrow(!0),this.scheduleOnce(this.showPickTip,5),this.ui_btn_drop.visible=!0),this.controller.Model.nowTokenPos==this.controller.Model.myPos&&(this.dapaiCount+=1,i="1"==g.AppConst.languageType?"english":"hindi",c.CommonCtr.instance.ShowTipLabel(xgameTable.getComplanguageRummyById(49)[i])),this.controller.Model.nowTokenPos=t.pos,[2]}})})},e.prototype.showPickTip=function(){this.ui_pickTip.visible=!0,this.showArrow(!1)},e.prototype.leaveTable=function(t){for(var e=0;e<6;e++)this.players[e].seatEmpty||-1!=t.userid.indexOf(this.players[e].userid)&&this.players[e].userid==g.AppConst.mPlayerModel.userid&&(this.ready=!1)},e.prototype.sc_one_exittable_n=function(t){if(this.controller.Model.goHall){var e=this.transformationPos(t.pos);this.players[e].exit(),this.playerCount-=1,1==this.playerCount&&(this.ui_statrWaitone.visible=!0,this.ui_statrWait.visible=!1);for(var i=-1,s=0;s<this.controller.Model.tableAllPlayer.length;s++)this.controller.Model.tableAllPlayer[s].userid==t.userid&&(i=s);i>-1&&this.controller.Model.tableAllPlayer.splice(i,1),t.pos==this.controller.Model.myPos&&this.gotoHall()}},e.prototype.sc_refhuff_rummy_n=function(t){var e=this;this.ui_OutCard.url="",this.xipaiEff.play(function(){e.ui_openNum.setVar("num","1").flushVars(),e.giveupPoker.length=0,e.giveupPoker.push(t.outcard),6==e.controller.Model.entertable._recover.pc?e.closeNum=107-13*e.controller.Model.tablestartData.dices.length-1:e.closeNum=53-13*e.controller.Model.tablestartData.dices.length-1,e.ui_OutCard.url=e.pokerResStart+t.outcard,e.ui_btn_pokerback.visible=!0,e.ui_cardEff.visible=!0,e.ui_closeNum.setVar("num",e.closeNum+"").flushVars()},1)},e.prototype.gameReconnection=function(){this.animationPlayOver=!0;var t=2==this.controller.Model.gameType;this.players[1].visible=!t,this.players[2].visible=!t,this.players[4].visible=!t,this.players[5].visible=!t;for(var e=this.controller.Model.entertable,i=e._recover,s=!0,o=0;o<i._pos2tile.length;o++)i._pos2tile[o].pos==this.controller.Model.myPos&&i._pos2tile[o].vallist.length>0&&(s=!1);if(!s&&i.wildCard>0&&e.palyerlist.length>1){this.ui_LeprosyCard.url=this.pokerResStart+i.wildCard,i.diPai&&(this.ui_OutCard.url=this.pokerResStart+i.diPai),this.ui_btn_outlog.visible=!0,this.commonPoker2=i.wildCard,16==i.wildCard||17==i.wildCard?this.commonPoker=214:this.commonPoker=i.wildCard,this.gameState=1,16==i.diPai||17==i.diPai||i.diPai%100==this.commonPoker%100?this.ui_OutCard.color=cc.Color.set(this.outPokerColor,255,232,127):this.ui_OutCard.color=cc.Color.set(this.outPokerColor,255,255,255),this.ui_finishbg.visible=!0,this.ui_finish.visible=!0,this.ui_btn_pokerback.visible=!0,this.ui_btn_pokerback.x=865,this.ui_LeprosyCard.x=760,this.ui_cardEff.x=862,this.ui_cardEff.visible=!0,this.ui_btn_drop.title=-i.dropTimes*this.controller.Model.baserate+"",this.controller.Model.tablestartData=new M.sc_tablestart_rummy_n,this.controller.Model.tablestartData.dices=[],this.resoutPanel.cleanList(),this.resoutPanel.fguiComponent.visible=!1,this.ui_viewcom.visible=!1,this.finishView.fguiComponent.visible=!1,this.ui_closeNum.visible=!0,this.ui_openNum.visible=!0,this.closeNum=i.mjc-1,this.ui_closeNum.setVar("num",this.closeNum+"").flushVars();var r,n,a=0;for(o=0;o<i._pos2tile.length;o++)a+=i._pos2tile[o].vallist.length;n=6==i.pc?108:54;for(var l,u=!1,h=(o=0,i._pos2Status.length);o<h;o++)if(5==i._pos2Status[o].val){u=!0,l=i._pos2Status[o].pos,this.fisrtHuPos=l;break}for(o=0,h=i._pos2datile.length;o<h;o++)if(i._pos2datile[o].pos==l){this.ui_finishCard.url=this.pokerResStart+i._pos2datile[o].vallist[i._pos2datile[o].vallist.length-1];break}for(r=n-i.mjc-a-(u?1:0),this.giveupPoker.length=r<0?0:r,this.ui_openNum.setVar("num",r+"").flushVars(),o=0,h=i._pos2gold.length;o<h;o++)if(i._pos2gold[o].pos==g.AppConst.mPlayerModel.userid){this.initSeat(i._pos2gold[o].val);break}var c=0;for(o=0,h=i._pos2Status.length;o<h;o++){this.controller.Model.tablestartData.dices[o]={pos:i._pos2Status[o].pos,val:0};var p=this.transformationPos(i._pos2Status[o].pos),d=i._pos2Status[o].val;if(2==d&&this.players[p].setDrop(!0),i._pos2Status[o].pos==this.controller.Model.myPos){if(this.mySitDown=!0,c=d,2==d&&(this.myDrop=!0),0==i._pos2tile[o].vallist.length)continue;this.ui_pokerDropMask.visible=!1,this.ui_btn_sort.visible=!0;var m=0;this.recoveryPoker(),this.myPokers.length=0,this.myCards.length=0;for(var _=0;_<i._pos2tile[o].vallist.length;_++){var f=this.createPoker();f.setData(i._pos2tile[o].vallist[_],!0),this.ui_pokerNode.addChild(f),this.myPokers[m]=f,this.myCards[m]=i._pos2tile[o].vallist[_],m++}this.startSortPoker(null),2==d&&this.myPokers.forEach(function(t){t.cleanEvent()})}}if(1==this.gameState)if(u){this.gameState=0,l==this.controller.Model.myPos||(this.otherHupai=!0,1==c?this.ui_btn_declare.visible=!0:this.myPokers.forEach(function(t){t.cleanEvent()}));var y=void 0;for(o=0;o<e.palyerlist.length;o++)if(l==e.palyerlist[o].pos){y=e.palyerlist[o].py.wechat.wName;break}var v=b.UIUtil.getNickNameSub(y,6,"");y=y.length>v.length?v+"...":v;var C="1"==g.AppConst.languageType?"english":"hindi";this.showTips("[color=#FFD422]"+y+"[/color] "+xgameTable.getComplanguageRummyById(57)[C],i.lt,1)}else i.tokenpos==this.controller.Model.myPos?(this.controller.Model.nowTokenPos=this.controller.Model.myPos,14==this.myPokers.length?(this.ui_btn_drop.visible=!1,this.players[0].startOpt(i.lt),this.players[0].isCanOperation=!1,this.hasMopai=!0):(this.mopaiNow=!1,this.ExecutePlayer(i.tokenpos,i.lt))):this.ExecutePlayer(i.tokenpos,i.lt)}},e.prototype.switchtable=function(){if(this.ui_shareCom.visible){this.cleanTable();for(var t=1;t<6;t++)this.players[t].seatEmpty||this.players[t].exit();for(t=0;t<6;t++)this["ui_chat"+t].visible=!1;return this.ui_pokerDropMask.visible=!1,this.ui_shareCom.visible=!1,this.playerCount=0,this.isleven=!1,this.controller.Model.init(),void this.controller.cs_entertable_rummy()}if(this.ui_nomoney.visible){if(g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide)return;this.showAddCash()}else this.ui_pokerDropMask.visible=!1,this.ready=!0},e.prototype.switchtable1=function(){if(this.showMenu(),!this.controller.Model.goHall)return this.controller.Model.goHall=!0,this.isleven=!0,void this.gotoHall();this.myDrop||this.isMeHupai||0==this.gameState?(this.isleven=!0,this.controller.Model.goHall=!1,this.controller.cs_applyexittable_rummy()):c.CommonCtr.instance.ShowTipLabel(u.BaseCode[g.AppConst.languageType].WAIT_GAME_END)},e.prototype.report=function(){var t;return n(this,void 0,void 0,function(){var e,i,s;return a(this,function(){for(e=0,i=(null===(t=this.controller.Model.endData)||void 0===t?void 0:t._pos2win)||[],s=0;s<i.length;s++)if(i[s].pos==g.AppConst.mPlayerModel.userid){e=i[s].val;break}return e=-e,_.default.Singleton.reportGameRound(b.UIUtil.formatNumber100(e)),[2]})})},e.prototype.showWithdrawCom=function(){this.controller.Model.endData&&this.controller.Model.endData.isWithdr&&(g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide||(this.ui_withdrawcom.visible=!0))},e.prototype.endGame=function(){var t,e,i=this;if(!this.isExit){this.report(),this.ui_statrWait.visible||this.ui_viewcom.visible?(this.showWaitTimes(),this.resoutPanel.updateGold()):(this.resoutPanel.fguiComponent.visible||(null===(t=c.CommonCtr.instance.view)||void 0===t||t.Hide(),this.resoutPanel.Show()),this.resoutPanel.initData()),this.cleanTable(),this.gameState=0,this.controller.Model.endData.isWithdr&&(this.resoutPanel.fguiComponent.visible||g.AppConst.gameStatus[1]==g.EnumGameStatus.Hide||(this.ui_withdrawcom.visible=!0),this.controller.Model.goHall&&(this.controller.Model.goHall=!1,this.controller.cs_applyexittable_rummy()),this.ready=!1);var s=this.ui_pokerDropMask.visible,o=this.ui_nomoney.visible;if(s&&this.ui_cardTimeOut.visible&&this.islevel)this.controller.cs_applyexittable_rummy();else if((null===(e=this.controller.Model.endData)||void 0===e?void 0:e.ptime)>=10&&this.controller.Model.isTyc){var r="1"==g.AppConst.languageType?"english":"hindi";c.CommonCtr.instance.ShowTipCallback(xgameTable.getComplanguageRummyById(61)[r],function(){i.gotoHall()})}else o||(this.ui_pokerDropMask.visible=!1),this.scheduleOnce(function(){o||(i.ui_pokerDropMask.visible=!1)},1),this.scheduleOnce(function(){(s=i.ui_pokerDropMask.visible)&&i.ui_cardTimeOut.visible&&i.islevel?i.controller.cs_applyexittable_rummy():(o||(i.ui_pokerDropMask.visible=!1),i.mySitDown&&!s&&i.ready&&i.controller.cs_ready_rummy())},2)}},e.prototype.cleanTable=function(){this.clean(),this.showArrow(!1),this.gift&&this.gift.Hide(),this.unschedule(this.showPickTip),this.ui_shareCom.visible=!1,this.ui_pickTip.visible=!1,this.ui_closeNum.setVar("num","0").flushVars(),this.ui_openNum.setVar("num","0").flushVars(),this.ui_cardEff.visible=!1,this.ui_finishCard.url="",this.ui_closeNum.visible=!1,this.ui_openNum.visible=!1,this.currentPoker=null,this.otherHupai=!1,this.hasMopai=!1,this.recoveryPoker(),this.gameState=0,this.giveupPoker.length=0,this.recoveryTitle(),this.ui_btn_sort.visible=!1,this.ui_btn_declare.visible=!1,this.ui_btn_discard.visible=!1,this.ui_btn_drop.visible=!1,this.ui_btn_group.visible=!1,this.ui_LeprosyCard.url="",this.ui_OutCard.url="",this.effectiveGroup=0,this.ui_btn_pokerback.x=1102,this.ui_btn_finish.visible=!1,this.isCanHupai=!1,this.showTips("",0),this.ui_btn_outlog.visible=!1,this._first_group=!1,this._second_group=!1,this.allPoints=0,this.ui_allPoints.text="0",this.myDrop=!1,this.ui_outPokerPanel.visible=!1,this.ui_waitTurn.visible=!1,this.ui_viewcom.visible=!1},e.prototype.clean=function(){this.players.forEach(function(t){t.stopTime(),t.setZhuang(!1),t.setDrop(!1)})},e.prototype.getPoker=function(){return this.pokerPool.length<=0&&this.pokerPool.push(fgui.UIPackage.createObject("rummy","poker")),this.pokerPool.shift()},e.prototype.addPoker=function(t){this.pokerPool.push(t)},e.prototype.createPoker=function(){var t=this.getPoker();return t.node.scale=1,t},e.prototype.createGroupTitle=function(){return this.titlePool.length>0?this.titlePool.shift():fgui.UIPackage.createObject("rummy","groupPoker")},e.prototype.addTitle=function(t){this.titlePool.push(t)},e.prototype.recoveryTitle=function(){for(;this.ui_groupNode.numChildren>0;)this.addTitle(this.ui_groupNode.removeChildAt(0))},e.prototype.recoveryPoker=function(){for(;this.ui_pokerNode.numChildren>0;){var t=this.ui_pokerNode.removeChildAt(0);t.node.stopAllActions(),this.addPoker(t)}},e.prototype.gotoHall=function(){if(this.isleven){this.cleanTable();for(var t=1;t<6;t++)this.players[t].seatEmpty||this.players[t].exit();for(t=0;t<6;t++)this["ui_chat"+t].visible=!1;return this.ui_pokerDropMask.visible=!1,this.ui_shareCom.visible=!1,this.playerCount=0,this.isleven=!1,this.controller.Model.init(),void this.controller.cs_entertable_rummy()}this.controller.Model.goHall&&(this.unscheduleAllCallbacks(),cc.game.off(cc.game.EVENT_SHOW),cc.game.off(cc.game.EVENT_HIDE),h.BaseFrameNative.nowGameView=null,this.controller&&(this.controller.view=null,this.controller.Model.init(),k.default.Destroy(),this.controller=null),this.players.forEach(function(t){t.stopTime(),t.clean()}),this.players=null,this.recoveryPoker(),this.pokerPool.forEach(function(t){t.node.stopAllActions(),t&&t.dispose()}),this.titlePool.forEach(function(t){t&&t.dispose()}),this.pokerPool.length=0,this.resoutPanel.clean(),f.SceneManager.Singleton.loadScene("GameHall","gameHall"))},e.prototype.onDestroy=function(){k.default.Destroy(),fgui.UIPackage.removePackage(this.packageName)},r([G],e)}(y.default);i.default=D,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../../../../Common/script/base/AudioManager":void 0,"../../../../Common/script/base/BaseCode":void 0,"../../../../Common/script/base/BaseFrameNative":void 0,"../../../../Common/script/base/CommonCtr":void 0,"../../../../Common/script/base/CommonView":void 0,"../../../../Common/script/base/MgrNative":void 0,"../../../../Common/script/base/ReconnectManager":void 0,"../../../../Common/script/base/ReportManager":void 0,"../../../../Common/script/base/SceneManager":void 0,"../../../../Common/script/base/ViewBase":void 0,"../../../../Common/script/util/UIUtil":void 0,"../../../../GameHall/script/Module/ChatView/ChatView":void 0,"../../../../GameHall/script/Module/ComSettingView/ComSettingView":void 0,"../../../../GameHall/script/Module/GiftView/GiftView":void 0,"../../../../GameHall/script/Module/RechargeView/RechargeView":void 0,"../Controller/RummyController":"RummyController","../Model/Rummy":"Rummy","../Model/RummyModel":"RummyModel","./GroupTitle":"GroupTitle","./Player":"Player","./Poker":"Poker","./RummyFinish":"RummyFinish","./RummyHelp":"RummyHelp","./RummyResout":"RummyResout","./RummyResoutItem":"RummyResoutItem"}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"85ada+RXt1IGoO049bQhq48","Player");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Common/script/base/AudioManager"),n=t("../../../../Boot/scirpt/AppConst"),a=t("../../../../Common/script/util/UIUtil"),l=t("../Controller/RummyController"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.headId="0",e.nickName="",e.seatEmpty=!0,e.ui_endTimeSpineNode=null,e.ui_endTimeXing=null,e.times=25,e.isCanOperation=!1,e.radius=80,e}return o(e,t),e.prototype.onConstruct=function(){this.head=this.getChild("head").asCom.getChild("head").asLoader,this.timeLabel=this.getChild("timeLabel").asTextField,this.iszhuang=this.getChild("n9").asImage,this.timeImg=this.getChild("timeimg").asLoader,this.typeController=this.getController("c1"),this.typeMController=this.getController("c2"),this.myname=this.getChild("myname").asTextField,this.dropImg=this.getChild("dropImg").asImage,this.drop=this.getChild("drop").asGraph,this.gift=this.getChild("gift").asImage,this.emj=this.getChild("emj").asLoader,this.ui_endTimeSpineNode=this.getChild("endTimeSpineNode").asLoader,this.ui_endTimeXing=this.getChild("endTimeXing").asCom,this.onClick(this.sitDown,this),this.addSpine()},e.prototype.addSpine=function(){var t=this;cc.assetManager.getBundle("rummy").load("res/prefabs/daojishi_lizi",cc.Prefab,function(e,i){if(!e){var s=cc.instantiate(i);t.ui_endTimeXing.node.addChild(s),t.moveN1toN2(s,t.ui_endTimeXing.node)}})},e.prototype.moveN1toN2=function(t,e){t.position=t.parent.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position))},e.prototype.convertNodeSpaceAR=function(t,e){return t.parent.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position))},e.prototype.sitDown=function(){this.seatEmpty||0==this.seatIndex||l.default.instance.view.showGiftPanel(this)},e.prototype.initUiSeat=function(t){this.seatIndex=t},e.prototype.initData=function(t){this.setHead(t.head);var e=a.UIUtil.getNickNameSub(t.nickName,6,"");this.nickName=t.nickName.length>e.length?e+"...":e,this.userid=t.userid,this.seatEmpty=!1,this.pos=t.tpos,this.headId=t.head,t.userid!=n.AppConst.mPlayerModel.userid?(this.myname.text=this.nickName,this.typeMController.setSelectedIndex(1),this.radius=78):(this.typeMController.setSelectedIndex(0),this.radius=76)},e.prototype.getUserName=function(){return this.nickName},e.prototype.exit=function(){this.head.url="",this.userid=null,this.nickName=null,this.typeController.setSelectedIndex(0),this.setZhuang(!1),this.stopTime(),this.seatEmpty=!0,this.dropImg.visible=!1,this.drop.visible=!1},e.prototype.setDrop=function(t){void 0===t&&(t=!0),this.dropImg.visible=t,this.drop.visible=t},e.prototype.setZhuang=function(t){void 0===t&&(t=!0),this.iszhuang.visible=t},e.prototype.setHead=function(t){this.typeController.setSelectedIndex(1),a.UIUtil.loadImage(this.head,t)},e.prototype.getTimeNow=function(){return this.timeImg.visible},e.prototype.getDrop=function(){return this.dropImg.visible},e.prototype.startOpt=function(t){if(void 0===t&&(t=25),this.times=t,this.timeLabel.text=this.times+"",this.timeLabel.visible=!0,this.isCanOperation=!0,this.timeImg.url="ui://rummy/tx_1",25==t)this.timeImg.fillAmount=0;else{var e=t/25;this.timeImg.fillAmount=1-e}this.timeImg.visible=!0,this.node.stopAllActions(),this.startTime(),this.tweener&&this.tweener.stop(),this.ui_endTimeXing.visible=!0,this.xingxingPos=this.convertNodeSpaceAR(this.ui_endTimeXing.node,this.ui_endTimeSpineNode.node),this.tweener=cc.tween(this.timeImg).to(t,{fillAmount:1},{onUpdate:this.updateStar.bind(this)}).start()},e.prototype.updateStar=function(){if(cc.isValid(this.ui_endTimeXing)){var t=360*-this.timeImg.fillAmount;this.ui_endTimeXing.x=this.xingxingPos.x+this.radius*Math.sin(-t/180*3.14),this.ui_endTimeXing.y=this.xingxingPos.y+80+this.radius-this.radius*Math.cos(-t/180*3.14),this.ui_endTimeXing.node.angle=t+90}},e.prototype.startTime=function(){var t=this;this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.times-=1,t.times<=5&&"ui://rummy/tx_2"!=t.timeImg.url&&(t.timeImg.url="ui://rummy/tx_2"),5==t.times&&r.AudioManager.Singleton.play("","tick1"),t.timeLabel.text=t.times+"",t.times<=0?(t.timeImg.url="ui://rummy/tx_1",t.stopTime()):t.startTime()})))},e.prototype.stopTime=function(){r.AudioManager.Singleton.stopEffect("tick1"),this.stopTween(),this.isCanOperation=!1,this.node.stopAllActions(),this.timeLabel.visible=!1,this.timeImg.visible=!1},e.prototype.stopTween=function(){this.ui_endTimeXing.visible=!1,this.tweener&&this.tweener.stop()},e.prototype.onDestroy=function(){this.tweener&&this.tweener.stop()},e.prototype.clean=function(){clearTimeout(this.emjTimer)},e.prototype.showEmj=function(t){var e=this;clearTimeout(this.emjTimer),this.emj.url="ui://ChatView/"+t,this.emjTimer=setTimeout(function(){e.emj&&(e.emj.url="")},2e3)},e}(fgui.GComponent);i.default=u,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../../../../Common/script/base/AudioManager":void 0,"../../../../Common/script/util/UIUtil":void 0,"../Controller/RummyController":"RummyController"}],Poker:[function(t,e,i){"use strict";cc._RF.push(e,"4d7a1fhOVFA257f7Nc9Y6S8","Poker");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Common/script/base/AudioManager"),n=t("../Controller/RummyController"),a=t("../Model/Rummy"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.select=!1,e.groupIndex=20,e.isMove=!1,e.dragOut=!1,e.dragGroup=!1,e.movePos=new cc.Vec2(0,0),e._touchId=-1,e.tempLocp=new cc.Vec2(0,0),e.hupai=!1,e}return o(e,t),e.prototype.onConstruct=function(){this.pokerLoader=this.getChild("poker").asLoader,this.colorController=this.getController("c1"),this.linghtbg=this.getChild("linghtbg").asImage,this.outPokerRegion=n.default.instance.view.ui_lineout.node.position,this.finish=n.default.instance.view.ui_finish.node.position,this.newGroup=n.default.instance.view.ui_btn_newGroup.node.position;var t=n.default.instance.view.ui_pokerNode.globalToLocal(this.newGroup.x,this.newGroup.y);this.newGroup=new cc.Vec3(t.x,t.y,0)},e.prototype.showEff=function(){this.linghtbg.visible=!0,this.linghtbg.node.runAction(cc.blink(2,5))},e.prototype.setData=function(t,e,i){void 0===i&&(i=!1),this.linghtbg.visible=!1,this.sid=t,this.color=this.getColor(),this.points=this.getNum(),18==t&&n.default.instance.Model.gsb?this.pokerLoader.url="ui://rummy/cards"+t+"_2":this.pokerLoader.url="ui://rummy/cards"+t,this.groupIndex=20,this.select=!1,this.init(e),i?this.colorController.setSelectedIndex(0):16==this.points||17==this.points||this.points==n.default.instance.view.commonPoker%100?this.colorController.setSelectedIndex(1):this.colorController.setSelectedIndex(0)},e.prototype.getNum=function(){return this.sid%100},e.prototype.getColor=function(){return Math.floor(this.sid/100)},e.prototype.init=function(t){void 0===t&&(t=!0),t?(this.cleanEvent(),this.on(fgui.Event.TOUCH_BEGIN,this.touchstart,this),this.on(fgui.Event.TOUCH_MOVE,this.touchMove,this),this.on(fgui.Event.TOUCH_END,this.touchEnd,this)):this.cleanEvent()},e.prototype.cleanEvent=function(){this.off(fgui.Event.TOUCH_BEGIN,this.touchstart,this),this.off(fgui.Event.TOUCH_MOVE,this.touchMove,this),this.off(fgui.Event.TOUCH_END,this.touchEnd,this)},e.prototype.touchstart=function(t){-1==this._touchId&&(this._touchId=t.touchId,this.isMove=!1,n.default.instance.view.addNewGroupBool=!1,this.dragOut=!1,this.startTime=Date.now(),this.hupai=!1,this.dragGroup=!1,this.oldIndex=this.parent.getChildIndex(this),t.captureTouch())},e.prototype.touchMove=function(t){if(-1!=this._touchId&&t.touchId==this._touchId){if(Date.now()-this.startTime<100)return;this.movePos.x=t.pos.x,this.movePos.y=-t.pos.y;var e=this.movePos;if(n.default.instance.view.addNewGroupBool)return void(n.default.instance.view.ui_lineout.visible=!1);n.default.instance.view.showNewGroup(!0),13!=this.parent.getChildIndex(this)&&this.parent.setChildIndex(this,13),e.y>-700?n.default.instance.view.ui_lineout.visible=!0:n.default.instance.view.ui_lineout.visible=!1,this.isMove||r.AudioManager.Singleton.play("","rummyFlip"),this.isMove=!0,this.parent.globalToLocal(t.pos.x,-t.pos.y,this.tempLocp),this.node.setPosition(this.tempLocp),this.tempLocp.x>this.newGroup.x&&this.tempLocp.x<this.newGroup.x+182&&this.tempLocp.y<this.newGroup.y&&this.tempLocp.y>this.newGroup.y-276&&!n.default.instance.view.addNewGroupBool?(this.dragOut=!1,this.select=!1,this.dragGroup=!0):this.tempLocp.x>this.finish.x-83.5&&this.tempLocp.x<this.finish.x+83.5&&this.tempLocp.y<this.finish.y+114&&this.tempLocp.y>this.finish.y-114?(this.hupai=!0,this.dragOut=!1,this.select=!1,this.dragGroup=!1):e.y>this.outPokerRegion.y&&n.default.instance.view.hasMopai?(this.dragOut=!0,this.select=!0,this.hupai=!1,this.dragGroup=!1):(this.dragOut=!1,this.select=!1,this.hupai=!1,this.dragGroup=!1)}},e.prototype.touchEnd=function(t){if(-1!=this._touchId&&t.touchId==this._touchId){if(this._touchId=-1,n.default.instance.view.showNewGroup(!1),n.default.instance.view.ui_lineout.visible=!1,this.parent.setChildIndex(this,this.oldIndex),this.dragGroup)return void n.default.instance.view.addNewGroup(this);if(this.hupai)return n.default.instance.view.setCurrentPoker(this),a.Rummy.AddorRemoveSelect(this,!0),n.default.instance.view.GroupBtn(this),void n.default.instance.view.finishCard(null,this,this.oldIndex);if(this.dragOut)return this.dragOut=!1,n.default.instance.view.addNewGroupBool=!0,n.default.instance.view.setCurrentPoker(this),void n.default.instance.view.outPoker();this.isMove?n.default.instance.view.moveEnd(this):(this.isMove=!1,this.select?(this.select=!1,this.node.y=-760,r.AudioManager.Singleton.play("","rummyCardDeselect")):(this.select=!0,this.node.y=-730,r.AudioManager.Singleton.play("","rummyCardSelect"),n.default.instance.view.setCurrentPoker(this)),a.Rummy.AddorRemoveSelect(this,this.select),1==n.default.instance.Model.selectCard.length?n.default.instance.view.GroupBtn(n.default.instance.Model.selectCard[0]):n.default.instance.view.GroupBtn(this))}},e}(fgui.GComponent);i.default=l,cc._RF.pop()},{"../../../../Common/script/base/AudioManager":void 0,"../Controller/RummyController":"RummyController","../Model/Rummy":"Rummy"}],RummyController:[function(t,e,i){"use strict";cc._RF.push(e,"7d2a6FEwohFq7Iji02wulFV","RummyController"),Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../../../Common/script/base/BaseCode"),o=t("../../../../Common/script/base/BaseFrameNative"),r=t("../../../../Common/script/base/CommonCtr"),n=t("../../../../Common/script/base/cs_base"),a=t("../../../../Common/script/base/WebSocketManager"),l=t("../../../../Boot/scirpt/AppConst"),u=t("../../../../Common/script/modules/@mogafa/utils/lib/HttpApi"),h=t("../../../../Common/script/util/UIUtil"),c=t("../../../../GameHall/dlc/script/config/LocalizationConfig"),p=t("../Model/RummyModel"),d=function(){function t(){this.view=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t,this._instance.RegistNotify()),this._instance},enumerable:!1,configurable:!0}),t.Destroy=function(){this._instance&&(this._instance.UnRegistNotify(),this._instance._model=null,this._instance=null)},t.prototype.RegistNotify=function(){var t=a.WebSocketManager.getInstance;t.RegistNotify("sc_tablestart_rummy_n",this.sc_tablestart_rummy_n,this),t.RegistNotify("sc_dapai_rummy_n",this.sc_dapai_rummy_n,this),t.RegistNotify("sc_mopai_rummy_n",this.sc_mopai_rummy_n,this),t.RegistNotify("sc_end_rummy_n",this.sc_end_rummy_n,this),t.RegistNotify("sc_sitdown_rummy_n",this.sc_sitdown_rummy_n,this),t.RegistNotify("sc_drop_rummy_n",this.sc_drop_rummy_n,this),t.RegistNotify("sc_situpkeep_rummy_n",this.sc_situpkeep_rummy_n,this),t.RegistNotify("sc_finish_rummy_n",this.sc_finish_rummy_n,this),t.RegistNotify("sc_chat_n",this.sc_chat_n,this),t.RegistNotify("sc_token_rummy_n",this.sc_token_rummy_n,this),t.RegistNotify("sc_one_exittable_n",this.sc_one_exittable_n,this),t.RegistNotify("sc_refhuff_rummy_n",this.sc_refhuff_rummy_n,this),t.RegistNotify("sc_addgoldingame",this.sc_addgoldingame,this),t.RegistNotify("sc_freshgold_n",this.sc_freshgold_n,this)},t.prototype.UnRegistNotify=function(){var t=a.WebSocketManager.getInstance;t.UnRegistNotify("sc_tablestart_rummy_n",this.sc_tablestart_rummy_n,this),t.UnRegistNotify("sc_dapai_rummy_n",this.sc_dapai_rummy_n,this),t.UnRegistNotify("sc_mopai_rummy_n",this.sc_mopai_rummy_n,this),t.UnRegistNotify("sc_end_rummy_n",this.sc_end_rummy_n,this),t.UnRegistNotify("sc_sitdown_rummy_n",this.sc_sitdown_rummy_n,this),t.UnRegistNotify("sc_drop_rummy_n",this.sc_drop_rummy_n,this),t.UnRegistNotify("sc_situpkeep_rummy_n",this.sc_situpkeep_rummy_n,this),t.UnRegistNotify("sc_finish_rummy_n",this.sc_finish_rummy_n,this),t.UnRegistNotify("sc_chat_n",this.sc_chat_n,this),t.UnRegistNotify("sc_token_rummy_n",this.sc_token_rummy_n,this),t.UnRegistNotify("sc_one_exittable_n",this.sc_one_exittable_n,this),t.UnRegistNotify("sc_refhuff_rummy_n",this.sc_refhuff_rummy_n,this),t.UnRegistNotify("sc_addgoldingame",this.sc_addgoldingame,this),t.UnRegistNotify("sc_freshgold_n",this.sc_freshgold_n,this)},Object.defineProperty(t.prototype,"Model",{get:function(){return null==this._model&&(this._model=new p.RummyModel),this._model},enumerable:!1,configurable:!0}),t.prototype.acceptMsg=function(){return!this.view||cc.game.isPaused()||!this.Model.isjoinGame},t.prototype.sc_freshgold_n=function(t){if(this.view&&1==t.result){if(2==t.source&&this.Model.isTyc)return;2==t.freshType&&this.view.setUserGold(t.gold)}},t.prototype.sc_addgoldingame=function(t){if(this.view&&1==t.result){if(this.Model.isTyc)return;1==t.status&&(l.AppConst.mPlayerModel.bReCharge=!0,r.CommonCtr.instance.ShowTipLabel(c.rummyConf.tips[210518]["text"+l.AppConst.languageType])),this.view.setUserGold(t.lGold)}},t.prototype.cs_entertable_rummy=function(){var t=new p.cs_entertable_rummy;t.fn="cs_entertable_rummy",t.levelid=h.UIUtil.CheckGameLeveID(this.Model.gameid,l.AppConst.currentlevelid),t.tableid=l.AppConst.tableid||0,t._g=91001,t.playercount=6,a.WebSocketManager.getInstance.SendJSON(t,this.sc_entertable_rummy.bind(this))},t.prototype.sc_entertable_rummy=function(t){var e=this;if(this.Model.hasGame=!0,this.view){var i=null;if(r.CommonCtr.instance.HideLoading(!0),1==t.result){l.AppConst.mPlayerModel.state=0,l.AppConst.tableid=null,this.Model.isjoinGame=!0,this.Model.tableid=t.tableid,this.Model.levelid=t.levelid,this.Model.gameid=t.gameid,this.Model.entertable=t,this.Model.tableAllPlayer.length=0,this.Model.gameType=t._recover.pc,this.Model.isTyc="0"==(t.levelid+"").slice(-1),this.Model.baserate=h.UIUtil.formatNumber100(t.brate),this.view.playerCount=0,this.view.ui_rummyBet.setVar("bet",this.Model.baserate+"").flushVars(),this.view.mySitDown=!1,this.view.requesting=!1,this.Model.gsb=l.AppConst.gameStatus[1]==l.EnumGameStatus.Hide,this.view.cleanChat(),this.Model.goHall=!0,this.view.ready=!0;for(var o=0;o<t.palyerlist.length;o++){var n=0==t.palyerlist[o].pos?6:t.palyerlist[o].pos,a=t.palyerlist[o].py.wechat.wicon,u=t.palyerlist[o].py.wechat.wName,c=t.palyerlist[o].py.userid,p={tpos:n,head:a,nickName:u,userid:c};c==l.AppConst.mPlayerModel.userid?(this.Model.myPos=n,this.view.mySitDown=!0):this.Model.tableAllPlayer.push(p)}this.view.unscheduleAllCallbacks(),this.view.cleanTable()}else this.Model.isjoinGame=!1,i=s.BaseErrorCode[l.AppConst.languageType][t.result]||s.BaseErrorCode[l.AppConst.languageType][0],r.CommonCtr.instance.ShowTipCallback(i,function(){e.view.gotoHall()})}},t.prototype.sc_sitdown_rummy_n=function(t){if(!this.acceptMsg()&&1==t.result){var e={tpos:t.tpos,head:t.user.py.wechat.wicon,nickName:t.user.py.wechat.wName,userid:t.user.py.userid};if(t.user.py.userid==l.AppConst.mPlayerModel.userid){this.Model.myPos=t.tpos;for(var i=0;i<this.Model.tableAllPlayer.length;i++)this.view.playerCount+=1,this.view.addNewPlayer(this.Model.tableAllPlayer[i]);this.view.initSeat(t.gold),this.view.addNewPlayer(e),this.view.playerCount+=1,this.Model.tableAllPlayer.length<=0&&(this.view.ui_statrWaitone.visible=!0),this.view.mySitDown?(this.view.ui_statrWait.visible=!1,this.view.gameReconnection()):(this.view.mySitDown=!0,this.Model.tableAllPlayer.length>0&&this.view.gameStartTimes())}else this.view.playerCount+=1,this.view.ui_statrWaitone.visible=!1,2==this.view.playerCount&&(this.view.ui_statrWaitone.visible=!1,this.view.gameStartTimes()),this.view.addNewPlayer(e)}},t.prototype.sc_tablestart_rummy_n=function(t){this.acceptMsg()||1==t.result&&(this.Model.tablestartData=t,this.view.gameStart())},t.prototype.sc_end_rummy_n=function(t){this.acceptMsg()||1==t.result&&(this.Model.endData=t,this.view.endGame())},t.prototype.cs_dapai_rummy=function(t,e){var i=new p.cs_dapai_rummy;i.fn="cs_dapai_rummy",i.levelid=this.Model.levelid,i.tableid=this.Model.tableid,i.dapai=t,i.comCards=e,i._g=this.Model.gameid,a.WebSocketManager.getInstance.SendJSON(i,this.sc_dapai_rummy.bind(this))},t.prototype.sc_dapai_rummy=function(t){this.view&&(1==t.result||(this.view.hasMopai=!0,r.CommonCtr.instance.ShowTipLabel(s.BaseErrorCode[l.AppConst.languageType][t.result])))},t.prototype.sc_dapai_rummy_n=function(t){this.acceptMsg()||1==t.result&&this.view.playDelPoker(t)},t.prototype.cs_mopai_rummy=function(t){var e=new p.cs_mopai_rummy;e.fn="cs_mopai_rummy",e.levelid=this.Model.levelid,e.tableid=this.Model.tableid,e.cardPos=t,e._g=this.Model.gameid,a.WebSocketManager.getInstance.SendJSON(e,this.sc_mopai_rummy.bind(this))},t.prototype.sc_mopai_rummy=function(t){this.acceptMsg()||(1==t.result?this.view.mopai(t.dapai,t.finish):(this.view.mopaiNow=!1,r.CommonCtr.instance.ShowTipLabel(s.BaseErrorCode[l.AppConst.languageType][t.result])))},t.prototype.sc_mopai_rummy_n=function(t){this.acceptMsg()||1==t.result&&this.view.noticeSomeMopai(t)},t.prototype.cs_drop_rummy=function(){var t=new p.cs_drop_rummy;t.fn="cs_drop_rummy",t.levelid=this.Model.levelid,t.tableid=this.Model.tableid,t._g=this.Model.gameid,a.WebSocketManager.getInstance.SendJSON(t,this.sc_drop_rummy.bind(this))},t.prototype.sc_drop_rummy=function(t){this.view&&1==t.result&&this.view.dropGold(t.punishScore)},t.prototype.sc_drop_rummy_n=function(t){this.acceptMsg()||1==t.result&&this.view.sc_drop_rummy_n(t)},t.prototype.cs_finish_rummy=function(t,e,i){void 0===i&&(i=0);var s=new p.cs_finish_rummy;s.fn="cs_finish_rummy",s.levelid=this.Model.levelid,s.tableid=this.Model.tableid,s._g=this.Model.gameid,s.bFirst=e,s.comCards=t,s.outCard=i,a.WebSocketManager.getInstance.SendJSON(s,this.sc_finish_rummy.bind(this))},t.prototype.sc_finish_rummy=function(t){this.view&&1==t.result&&this.view.setbtn_declare(t)},t.prototype.sc_finish_rummy_n=function(t){if(!this.acceptMsg()&&this.view){if(!this.view.controller)return;this.view.sc_startfinish_rummy_n(t)}},t.prototype.cs_applyexittable_rummy=function(){if(this.Model.hasGame){var t=new p.cs_applyexittable_rummy;t.fn="cs_applyexittable_rummy",t.levelid=this.Model.levelid,t.tableid=this.Model.tableid,t.gameid=this.Model.gameid,t._g=this.Model.gameid,a.WebSocketManager.getInstance.SendJSON(t,this.sc_applyexittable_rummy.bind(this))}},t.prototype.sc_applyexittable_rummy=function(t){this.view&&(1==t.result?this.view.gotoHall():(this.view.isleven=!1,r.CommonCtr.instance.ShowTipLabel(s.BaseErrorCode[l.AppConst.languageType][t.result])))},t.prototype.cs_ready_rummy=function(){if(this.Model.goHall){var t=new p.cs_ready_rummy;t.fn="cs_ready_rummy",t.levelid=this.Model.levelid,t.tableid=this.Model.tableid,t._g=this.Model.gameid,a.WebSocketManager.getInstance.SendJSON(t,this.sc_ready_rummy.bind(this))}},t.prototype.sc_ready_rummy=function(t){this.view&&(1==t.result||r.CommonCtr.instance.ShowTipLabel(s.BaseErrorCode[l.AppConst.languageType][t.result]))},t.prototype.sc_situpkeep_rummy_n=function(t){this.acceptMsg()||1==t.result&&this.view.leaveTable(t)},t.prototype.cs_getoutcard_rummy=function(){var t=new p.cs_getoutcard_rummy;t.fn="cs_getoutcard_rummy",t.levelid=this.Model.levelid,t.tableid=this.Model.tableid,t._g=this.Model.gameid,a.WebSocketManager.getInstance.SendJSON(t,this.sc_getoutcard_rummy.bind(this))},t.prototype.sc_getoutcard_rummy=function(t){this.view&&(this.view.requesting=!1,1==t.result&&this.view.showOutPokerPanel(t))},t.prototype.cs_chat=function(t,e,i){var s=new n.cs_chat;s.fn="cs_chat",s.levelid=this.Model.levelid,s.tableid=this.Model.tableid,s._g=this.Model.gameid,s.content=t,s.type=e,s.tpos=i,a.WebSocketManager.getInstance.SendJSON(s,this.sc_chat.bind(this))},t.prototype.sc_chat=function(t){this.view&&(1==t.result||r.CommonCtr.instance.ShowTipLabel(s.BaseErrorCode[l.AppConst.languageType][t.result]))},t.prototype.sc_chat_n=function(t){this.acceptMsg()||1==t.result&&this.view.sc_chat_n(t)},t.prototype.sc_token_rummy_n=function(t){this.acceptMsg()||1==t.result&&this.view.sc_token_rummy_n(t)},t.prototype.sc_one_exittable_n=function(t){if(!this.acceptMsg()&&1==t.result){if(t.gameid!=this.Model.gameid)return;this.view.sc_one_exittable_n(t)}},t.prototype.sc_refhuff_rummy_n=function(t){this.acceptMsg()||1==t.result&&this.view.sc_refhuff_rummy_n(t)},t.prototype.cs_makecard_rummy=function(t){var e=new p.cs_makecard_rummy;e.fn="cs_makecard_rummy",e.levelid=this.Model.levelid,e.tableid=this.Model.tableid,e._g=this.Model.gameid,e.comCards=t,a.WebSocketManager.getInstance.SendJSON(e,this.sc_makecard_rummy.bind(this))},t.prototype.sc_makecard_rummy=function(){},t.prototype.cs_sharerewards=function(){var t=o.BaseFrameNative.serverlistItem.apiAdress+"/api/SigIn/GetShareRewards",e={userid:l.AppConst.mPlayerModel.userid};u.default.http.post(t,e).then(function(t){t.Code}).catch(function(t){console.error("\u5206\u4eab\u5956\u52b12\u91d1\u5e01\u5f02\u5e38: "+JSON.stringify(t))})},t}();i.default=d,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../../../../Common/script/base/BaseCode":void 0,"../../../../Common/script/base/BaseFrameNative":void 0,"../../../../Common/script/base/CommonCtr":void 0,"../../../../Common/script/base/WebSocketManager":void 0,"../../../../Common/script/base/cs_base":void 0,"../../../../Common/script/modules/@mogafa/utils/lib/HttpApi":void 0,"../../../../Common/script/util/UIUtil":void 0,"../../../../GameHall/dlc/script/config/LocalizationConfig":void 0,"../Model/RummyModel":"RummyModel"}],RummyFinish:[function(t,e,i){"use strict";cc._RF.push(e,"7683aT9Ii5LjomidJPsF/1B","RummyFinish");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Common/script/base/AudioManager"),n=t("../../../../Common/script/base/ViewBase"),a=t("../../../../Boot/scirpt/AppConst"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui_btn_no=null,e.ui_btn_yes=null,e.ui_tips=null,e.ui_tips1=null,e.ui_btn_finish_no=null,e.ui_btn_finish_yes=null,e.ui_btn_finish_title=null,e.ui_tipsTitle=null,e}return o(e,t),Object.defineProperty(e.prototype,"packageResourceName",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packageName",{get:function(){return"res/rummy"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentName",{get:function(){return"finish"},enumerable:!1,configurable:!0}),e.prototype.createChildComponents=function(){t.prototype.createChildComponents.call(this),this.fguiComponent.visible=!1,this.ui_btn_no.onClick(this.noFinish,this),this.ui_btn_yes.onClick(this.yesFinish,this),"2"==a.AppConst.languageType&&this.setLanguage()},e.prototype.setLanguage=function(){for(var t="1"==a.AppConst.languageType?"english":"hindi",e=1;e<6;e++){var i=xgameTable.getComplanguageRummyById(e);i&&i.comp&&this[i.comp]&&(1==i.type?this[i.comp].text=i[t]:this[i.comp].url=i[t])}},e.prototype.noFinish=function(){this.noFunction&&this.noFunction(),this.Hide()},e.prototype.yesFinish=function(){this.yesFunction&&this.yesFunction(),this.Hide()},e.prototype.addFunction=function(t,e){this.noFunction=e,this.yesFunction=t},e.prototype.setTips=function(t){0==t?(this.ui_tips.visible=!0,this.ui_tips1.visible=!1):(this.ui_tips1.visible=!0,this.ui_tips.visible=!1)},e.prototype.Show=function(){t.prototype.Show.call(this),r.AudioManager.Singleton.play("","pop_up")},e.prototype.Hide=function(){t.prototype.Hide.call(this),r.AudioManager.Singleton.play("","btn_close")},e}(n.default);i.default=l,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../../../../Common/script/base/AudioManager":void 0,"../../../../Common/script/base/ViewBase":void 0}],RummyHelp:[function(t,e,i){"use strict";cc._RF.push(e,"b5d0dbn30lN572wiKaD0F4N","RummyHelp");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Common/script/base/AudioManager"),n=t("../../../../Common/script/base/ViewBase"),a=t("../../../../Boot/scirpt/AppConst"),l=t("../Controller/RummyController"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui_btn_break=null,e.ui_pokerbg1=null,e.ui_pokerbg2=null,e.ui_pokerbg3=null,e.ui_lab_help_sets=null,e.ui_lab_help_sequences=null,e.ui_lab_help_score=null,e.ui_lab_help_group=null,e.ui_lab_help_discard=null,e.ui_lab_help_declare=null,e.ui_lab_help_basics=null,e.ui_lab_help_add=null,e.ui_declare_title=null,e.ui_declare_lab1=null,e.ui_declare_lab2=null,e.ui_declare_lab3=null,e.ui_declare_lab4=null,e.ui_declare_lab5=null,e.ui_declare_lab6=null,e.ui_declare_lab7=null,e.ui_declare_lab8=null,e.ui_declare_lab9=null,e.ui_declare_lab10=null,e.ui_discard_lab_title=null,e.ui_discard_lab_1=null,e.ui_discard_lab_2=null,e.ui_discard_lab_3=null,e.ui_discard_lab_4=null,e.ui_discard_lab_5=null,e.ui_discard_lab_6=null,e.ui_discard_lab_7=null,e.ui_discard_lab_8=null,e.ui_discard_lab_9=null,e.ui_discard_lab_10=null,e.ui_discard_lab_11=null,e.ui_score_lab_title=null,e.ui_score_lab_1=null,e.ui_score_lab_2=null,e.ui_score_lab_3=null,e.ui_score_lab_4=null,e.ui_score_lab_5=null,e.ui_score_lab_6=null,e.ui_score_lab_7=null,e.ui_score_lab_8=null,e.ui_score_lab_9=null,e.ui_score_lab_10=null,e.ui_score_lab_11=null,e.ui_score_lab_12=null,e.ui_sequences_lab_title=null,e.ui_sequences_lab_1=null,e.ui_sequences_lab_2=null,e.ui_sequences_lab_3=null,e.ui_sequences_lab_4=null,e.ui_sequences_lab_5=null,e.ui_sequences_lab_6=null,e.ui_sequences_lab_7=null,e.ui_sequences_lab_8=null,e.ui_sequences_lab_9=null,e.ui_add_lab_title=null,e.ui_add_lab_1=null,e.ui_add_lab_2=null,e.ui_add_lab_3=null,e.ui_add_lab_4=null,e.ui_add_lab_5=null,e.ui_add_lab_6=null,e.ui_add_lab_7=null,e.ui_add_lab_8=null,e.ui_add_lab_9=null,e.ui_basics_lab_title=null,e.ui_basics_lab_1=null,e.ui_basics_lab_2=null,e.ui_basics_lab_3=null,e.ui_basics_lab_4=null,e.ui_basics_lab_5=null,e.ui_group_lab_title=null,e.ui_group_lab_1=null,e.ui_group_lab_2=null,e.ui_group_lab_3=null,e.ui_group_lab_4=null,e.ui_sets_lab_title=null,e.ui_sets_lab_1=null,e.ui_sets_lab_2=null,e.ui_sets_lab_3=null,e.ui_sets_lab_4=null,e.ui_sets_lab_5=null,e.ui_sets_lab_6=null,e.ui_sets_lab_7=null,e}return o(e,t),Object.defineProperty(e.prototype,"packageResourceName",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packageName",{get:function(){return"res/rummy"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentName",{get:function(){return"help"},enumerable:!1,configurable:!0}),e.prototype.createChildComponents=function(){t.prototype.createChildComponents.call(this),this.fguiComponent.visible=!1,this.ui_btn_break.onClick(this.Hide,this),"2"==a.AppConst.languageType&&this.setLanguage(),l.default.instance.Model.gsb&&(this.ui_pokerbg1.url="ui://rummy/cards18_2",this.ui_pokerbg2.url="ui://rummy/cards18_2",this.ui_pokerbg3.url="ui://rummy/cards18_2")},e.prototype.allChildCreated=function(){t.prototype.allChildCreated.call(this),this.Show()},e.prototype.Show=function(){t.prototype.Show.call(this),r.AudioManager.Singleton.play("","pop_up")},e.prototype.Hide=function(){t.prototype.Hide.call(this),r.AudioManager.Singleton.play("","btn_close")},e.prototype.setLanguage=function(){var t=xgameTable.getTableMgr().getSheet(xgameTable.EnumExcelKey.Complanguage,xgameTable.EnumComplanguage.Rummyhelp),e="1"==a.AppConst.languageType?"english":"hindi";for(var i in t){var s=t[i].comp;s&&this[s]&&1==t[i].type&&(this[s].text=t[i][e])}},e}(n.default);i.default=u,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../../../../Common/script/base/AudioManager":void 0,"../../../../Common/script/base/ViewBase":void 0,"../Controller/RummyController":"RummyController"}],RummyModel:[function(t,e,i){"use strict";cc._RF.push(e,"9b624C06N5DjIkIynVCeIdF","RummyModel");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.sc_sharerewards=i.cs_sharerewards=i.cs_makecard_rummy=i.sc_refhuff_rummy_n=i.sc_one_exittable_n=i.sc_token_rummy_n=i.sc_getoutcard_rummy=i.cs_getoutcard_rummy=i.sc_situpkeep_rummy_n=i.sc_enterrobot_rummy=i.cs_enterrobot_rummy=i.sc_entertable_rummy=i.cs_entertable_rummy=i.sc_getgamelevel=i.cs_getgamelevel=i.sc_end_rummy_n=i.sc_zhimohu_rummy_n=i.sc_hu_rummy=i.cs_hu_rummy=i.sc_finish_rummy_n=i.sc_finish_rummy=i.cs_finish_rummy=i.sc_drop_rummy=i.cs_drop_rummy=i.sc_mopai_rummy_n=i.sc_mopai_rummy=i.cs_mopai_rummy=i.sc_drop_rummy_n=i.sc_dapai_rummy_n=i.sc_dapai_rummy=i.cs_dapai_rummy=i.sc_tablestart_rummy_n=i.sc_ready_rummy_n=i.sc_ready_rummy=i.cs_ready_rummy=i.sc_applyexittable_rummy=i.cs_applyexittable_rummy=i.sc_sitdown_rummy_n=i.sc_sitdown_rummy=i.cs_sitdown_rummy=i.RummyModel=void 0;var r=t("../../../../Common/script/base/cs_base"),n=function(){function t(){this.tableid=0,this.gameid=91001,this.myPos=0,this.selectCard=[],this.nowTokenPos=0,this.baserate=0,this.tableAllPlayer=[],this.isTyc=!1,this.isjoinGame=!1,this.gsb=!1,this.hasGame=!1,this.goHall=!0}return t.prototype.init=function(){this.levellist=null,this.myPos=0,this.entertable=null,this.tablestartData=null,this.endData=null,this.selectCard.length=0,this.nowTokenPos=0,this.tableAllPlayer=[],this.tableid=0,this.goHall=!0},t}();i.RummyModel=n;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_sitdown_rummy=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_sitdown_rummy=l;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_sitdown_rummy_n=u;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_applyexittable_rummy=h;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_applyexittable_rummy=c;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_ready_rummy=p;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_ready_rummy=d;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_ready_rummy_n=m;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_tablestart_rummy_n=_;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_dapai_rummy=f;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_dapai_rummy=y;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_dapai_rummy_n=g;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_drop_rummy_n=b;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_mopai_rummy=v;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_mopai_rummy=C;var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_mopai_rummy_n=P;var w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_drop_rummy=w;var k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_drop_rummy=k;var T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_finish_rummy=T;var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_finish_rummy=M;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_finish_rummy_n=S;var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_hu_rummy=x;var I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_hu_rummy=I;var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_zhimohu_rummy_n=R;var N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_end_rummy_n=N;var A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_getgamelevel=A;var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_getgamelevel=O;var G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_entertable_rummy=G;var D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_entertable_rummy=D;var E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_enterrobot_rummy=E;var F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_enterrobot_rummy=F;var L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_situpkeep_rummy_n=L;var H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_getoutcard_rummy=H;var B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_getoutcard_rummy=B;var U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_token_rummy_n=U;var V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_one_exittable_n=V;var j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_refhuff_rummy_n=j;var W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_makecard_rummy=W;var q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.cs_base);i.cs_sharerewards=q;var z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r.sc_base);i.sc_sharerewards=z,cc._RF.pop()},{"../../../../Common/script/base/cs_base":void 0}],RummyResoutItem:[function(t,e,i){"use strict";cc._RF.push(e,"8a2dfLALA1ET6zyWeBNA0CG","RummyResoutItem");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Boot/scirpt/AppConst"),n=t("../../../../Common/script/util/UIUtil"),a=t("../Controller/RummyController"),l=t("../Model/Rummy"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.groupType=[],e.groupPoint=[],e}return o(e,t),e.prototype.onConstruct=function(){this.head=this.getChild("head").asCom.getChild("head").asLoader,this.points=this.getChild("points").asTextField,this.win=this.getChild("win").asTextField,this.userName=this.getChild("userName").asTextField,this.colorController=this.getController("c1");for(var t=0;t<14;t++)this["poker"+t]=this.getChild("poker"+t);this.groupTitle=this.getChild("groupTitle").asCom,this.meImg=this.getChild("me").asImage},e.prototype.setPoint=function(t){this.points.text=t+""},e.prototype.setWin=function(t){"0"!=this.points.text&&t>0||(this.win.text=n.UIUtil.formatNumber100(t)+"",t>0?(this.win.font="ui://rummy/infogfnt",this.colorController.setSelectedIndex(1)):this.win.font="ui://rummy/failfont")},e.prototype.playEffect=function(t){var e=this;this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(){cc.isValid(e.node)&&(e.node.opacity=255)})))},e.prototype.initData=function(t,e,i,s,o,u,h){this.userid=u,this.seatPos=i,u==r.AppConst.mPlayerModel.userid?this.meImg.visible=!0:this.meImg.visible=!1;var c=400;if(this.poker13.visible=!1,this.groupTitle.removeChildren(0,-1,!0),t&&t.length>0){this.points.text=(o>80?80:o||0)+"";var p=0,d=a.default.instance.view.wildPokerSid();if(this.groupType.length=0,this.groupPoint.length=0,2!=s){for(var m=0;m<t.length;m++){var _=fgui.UIPackage.createObject("rummy","groupPoker");_.x=c-3,_.y=81,_.height=40,_.width=40*t[m].length+31,_.title.fontSize=20,this.groupTitle.addChild(_);var f=l.Rummy.GetRummyTypeWild(t[m],d),y=this.getGroupPoint(t[m]);this.groupType.push(f),this.groupPoint.push(y);for(var g=t[m].length>14?14:t[m].length,b=0;b<g;b++)this["poker"+p].visible=!0,this["poker"+p].setData(2==s?18:t[m][b],!1),this["poker"+p].x=c,c+=40,p++;c+=50}this.checkGroupType()}else{this.points.text="0";var v=0;for(b=0;b<13;b++)this["poker"+v].visible=!0,this["poker"+v].setData(18,!1),this["poker"+v].x=c,c+=40,v++}}else for(this.points.text="0",p=0,b=0;b<13;b++)this["poker"+p].visible=!0,this["poker"+p].setData(18,!1),this["poker"+p].x=c,c+=40,p++;this.win.text=n.UIUtil.formatNumber100(e)+"",e>0?(this.colorController.setSelectedIndex(1),this.win.font="ui://rummy/infogfnt"):0==e&&0==o&&2!=s?h?(this.win.font="ui://rummy/infogfnt",this.colorController.setSelectedIndex(1)):(this.win.font="ui://rummy/failfont",this.colorController.setSelectedIndex(0)):(this.win.font="ui://rummy/failfont",2==s?this.colorController.setSelectedIndex(2):this.colorController.setSelectedIndex(0));var C=a.default.instance.view.playerInfo(i);this.setHead(C[0]),this.userName.text=C[1]},e.prototype.setHead=function(t){n.UIUtil.loadImage(this.head,t)},e.prototype.getGroupPoint=function(t){for(var e=0,i=a.default.instance.view.commonPoker%100,s=0;s<t.length;s++){var o=t[s]%100;16==o||17==o||o==i||(e+=o>10?10:o)}return e},e.prototype.checkGroupType=function(){var t,e=-1;t=this.groupType.lastIndexOf(14);for(var i=0;i<this.groupType.length;i++)-1!=t&&this.groupType[i]>2&&i!=t&&(e=i);var s="1"==r.AppConst.languageType?"english":"hindi";for(-1!=t&&((o=this.groupTitle.getChildAt(t)).setColor(0),o.setTitle(xgameTable.getComplanguageRummyById(51)[s])),-1!=e&&((o=this.groupTitle.getChildAt(e)).setColor(0),o.setTitle(xgameTable.getComplanguageRummyById(52)[s])),i=0;i<this.groupType.length;i++){var o=this.groupTitle.getChildAt(i);-1==t?(o.setColor(1),o.setTitle(xgameTable.getComplanguageRummyById(56)[s]+"("+(this.groupPoint[i]>80?80:this.groupPoint[i])+")")):i!=t&&i!=e&&(-1!=t&&-1!=e?1==this.groupType[i]||2==this.groupType[i]?(o.setColor(2),o.setTitle(xgameTable.getComplanguageRummyById(54)[s])):14==this.groupType[i]?(o.setColor(0),o.setTitle(xgameTable.getComplanguageRummyById(53)[s])):this.groupType[i]>2?(o.setColor(0),o.setTitle(xgameTable.getComplanguageRummyById(53)[s])):(o.setColor(1),o.setTitle(xgameTable.getComplanguageRummyById(56)[s]+"("+(this.groupPoint[i]>80?80:this.groupPoint[i])+")")):-1==e&&(1==this.groupType[i]||2==this.groupType[i]?(o.setColor(2),o.setTitle(xgameTable.getComplanguageRummyById(54)[s])):(o.setColor(1),o.setTitle(xgameTable.getComplanguageRummyById(56)[s]+"("+(this.groupPoint[i]>80?80:this.groupPoint[i])+")"))))}},e}(fgui.GComponent);i.default=u,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../../../../Common/script/util/UIUtil":void 0,"../Controller/RummyController":"RummyController","../Model/Rummy":"Rummy"}],RummyResout:[function(t,e,i){"use strict";cc._RF.push(e,"8acb1A/uKdA1IAWKsIjc8aH","RummyResout");var s,o=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Common/script/base/AudioManager"),n=t("../../../../Common/script/base/ReportManager"),a=t("../../../../Common/script/base/ViewBase"),l=t("../../../../Boot/scirpt/AppConst"),u=t("../../../../GameHall/dlc/script/Common/CaptureUtils"),h=t("../Controller/RummyController"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui_resoutList=null,e.ui_btn_start=null,e.ui_btn_leave=null,e.ui_times=null,e.ui_commCard=null,e.ui_resout_lab_1=null,e.ui_resout_lab_2=null,e.ui_resout_lab_3=null,e.ui_resout_lab_4=null,e.ui_resout_lab_5=null,e.ui_resout_lab_6=null,e.ui_resout_lab_7=null,e.ui_resout_lab_8=null,e.ui_timeLabel=null,e.ui_resout_lab_leave=null,e.ui_resout_lab_start=null,e.ui_socreTitle=null,e.ui_btn_share=null,e.times=5,e.startTime=!1,e}return o(e,t),Object.defineProperty(e.prototype,"packageResourceName",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packageName",{get:function(){return"res/rummy"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentName",{get:function(){return"resout"},enumerable:!1,configurable:!0}),e.prototype.createChildComponents=function(){t.prototype.createChildComponents.call(this),this.fguiComponent.visible=!1,this.ui_btn_start.onClick(this.clickStart,this),this.ui_btn_leave.onClick(this.gotoHall,this),"2"==l.AppConst.languageType&&this.setLanguage(),this.ui_btn_share.onClick(this.clickShare,this)},e.prototype.setLanguage=function(){for(var t="1"==l.AppConst.languageType?"english":"hindi",e=6;e<18;e++){var i=xgameTable.getComplanguageRummyById(e);i&&i.comp&&this[i.comp]&&(1==i.type?this[i.comp].text=i[t]:this[i.comp].url=i[t])}},e.prototype.allChildCreated=function(){t.prototype.allChildCreated.call(this),this.typeController=this.fguiComponent.getController("c1"),this.ui_resoutList.removeChildrenToPool()},e.prototype.cleanList=function(){this.ui_resoutList.removeChildrenToPool()},e.prototype.oneDataAdd=function(t,e,i,s,o,r,n){if(this.ui_resoutList.numChildren>1){var a=this.insertItem(o);if(-1==a){(m=this.ui_resoutList.addItemFromPool()).initData(t,e,i,s,o,r,1==this.ui_resoutList.numChildren);var l=this.ui_resoutList.getChildAt(0);return void(l.seatPos==h.default.instance.view.fisrtHuPos&&l.setWin(n))}if(this.fguiComponent.visible){for(var u=a,c=this.ui_resoutList.numChildren;u<c;u++){var p=(m=this.ui_resoutList.getChildAt(u)).y+147;fgui.GTween.to2(m.x,m.y,m.x,p,.2).setTarget(m,m.setPosition)}var d=this.ui_resoutList.getFromPool();d.initData(t,e,i,s,o,r,1==this.ui_resoutList.numChildren),d.visible=!1,this.ui_resoutList.addChildAt(d,a),fgui.GTween.to(1,10,.3).onComplete(function(){cc.isValid(d)&&(d.visible=!0)})}else(m=this.ui_resoutList.getFromPool()).initData(t,e,i,s,o,r,1==this.ui_resoutList.numChildren),this.ui_resoutList.addChildAt(m,a)}else{var m;(m=this.ui_resoutList.addItemFromPool()).initData(t,e,i,s,o,r,1==this.ui_resoutList.numChildren)}if(1!=this.ui_resoutList.numChildren){var _=this.ui_resoutList.getChildAt(0);_.seatPos==h.default.instance.view.fisrtHuPos&&_.setWin(n)}},e.prototype.insertItem=function(t){for(var e=1,i=this.ui_resoutList.numChildren;e<i;e++){var s=this.ui_resoutList.getChildAt(e);if(s&&t<+s.points.text)return e}return-1},e.prototype.showShare=function(){var t=l.AppConst.gameStatus[1]==l.EnumGameStatus.Hide;if(!t&&!this.ui_btn_share.visible){0==l.AppConst.mPlayerModel.ShareCount?t||this.ui_btn_share.getController("c1").setSelectedIndex(1):this.ui_btn_share.getController("c1").setSelectedIndex(0),this.ui_btn_share.visible=!0,n.default.Singleton.report("game_share");var e=this.fguiComponent.width;fgui.GTween.to2(e+360,53,e-360,53,.5).setTarget(this.ui_btn_share,this.ui_btn_share.setPosition)}},e.prototype.clickShare=function(){h.default.instance.Model.goHall&&h.default.instance.cs_applyexittable_rummy(),h.default.instance.Model.goHall=!1,u.default.capture(h.default.instance.view.fguiComponent.node,{},"0"),this.scheduleOnce(function(){h.default.instance.view.showShare()},1)},e.prototype.createCanvas=function(t){t.setFlipY(!0);var e=new cc.Node;e.addComponent(cc.Sprite).spriteFrame=t,e.zIndex=cc.macro.MAX_ZINDEX,e.parent=cc.director.getScene();var i=cc.winSize.width,s=cc.winSize.height;e.x=i/2,e.y=s/2,e.on(cc.Node.EventType.TOUCH_START,function(){e.parent=null,e.destroy()}),this.captureAction(e,i,s)},e.prototype.captureAction=function(t,e,i){var s=cc.scaleTo(.8,.2),o=cc.v2(e-e/6,i/4),r=cc.moveTo(.8,o),n=cc.spawn(s,r);t.runAction(cc.sequence(n,cc.delayTime(3),cc.callFunc(function(){t.parent=null,t.destroy()})));var a=cc.blink(.1,1);this.node.runAction(a)},e.prototype.initData=function(){this.typeController.setSelectedIndex(1);var t=h.default.instance.Model.endData;if(t._pos2win=t._pos2win.sort(function(t,e){return e.val-t.val}),this.ui_resoutList.numChildren<t._pos2win.length){this.ui_resoutList.removeChildrenToPool();for(var e=0;e<t._pos2win.length;e++){var i=this.ui_resoutList.addItemFromPool(),s=this.getUserWin(t._pos2win[e].pos),o=this.getUserState(t._pos2win[e].pos),r=this.getCard(t._pos2win[e].pos),n=this.getPoint(t._pos2win[e].pos);i.initData(r.comCard,s,r.pos,o,n.val,t._pos2win[e].pos)}}else{e=0;for(var a=this.ui_resoutList.numChildren;e<a;e++)i=this.ui_resoutList.getChildAt(e),n=this.getPoint(i.userid),i.setPoint(n.val),s=this.getUserWin(i.userid),i.setWin(s)}this.updateGold(),this.times=5,this.ui_times.text=this.times+"",this.node.stopAllActions(),this.showTime();var u=!1;if(2==h.default.instance.Model.gameType)for(e=0;e<t._pos2Status.length;e++)if(t._pos2Status[e].pos==l.AppConst.mPlayerModel.userid&&5==t._pos2Status[e].val){u=!0;break}(h.default.instance.view.fisrtHuPos==h.default.instance.Model.myPos||u)&&this.showShare()},e.prototype.updateGold=function(){for(var t=h.default.instance.Model.endData,e=0;e<t._pos2win.length;e++)if(t._pos2gold[e].pos==l.AppConst.mPlayerModel.userid){h.default.instance.view.setUserGold(t._pos2gold[e].val);break}},e.prototype.getCard=function(t){for(var e=h.default.instance.Model.endData,i=h.default.instance.view.getPlayerPos(t),s=0;s<e._pos2ShouPai.length;s++)if(i==e._pos2ShouPai[s].pos)return e._pos2ShouPai[s]},e.prototype.getPoint=function(t){for(var e=h.default.instance.Model.endData,i=h.default.instance.view.getPlayerPos(t),s=0;s<e._pos2Point.length;s++)if(i==e._pos2Point[s].pos)return e._pos2Point[s]},e.prototype.getUserWin=function(t){for(var e=h.default.instance.Model.endData,i=0;i<e._pos2win.length;i++)if(t==e._pos2win[i].pos)return e._pos2win[i].val;return 0},e.prototype.getUserState=function(t){for(var e=h.default.instance.Model.endData,i=0;i<e._pos2Status.length;i++)if(t==e._pos2Status[i].pos)return e._pos2Status[i].val},e.prototype.showTime=function(){var t=this;this.startTime=!0,this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.times-=1,t.ui_times.text=t.times+"",0==t.times?(t.startTime=!1,t.Hide()):t.showTime()})))},e.prototype.gotoHall=function(){r.AudioManager.Singleton.play("","btn_click"),h.default.instance.Model.goHall?h.default.instance.cs_applyexittable_rummy():(h.default.instance.Model.goHall=!0,h.default.instance.view.gotoHall())},e.prototype.Show=function(){this.typeController.setSelectedIndex(0);var e=h.default.instance.view.commonPoker2;this.ui_commCard.setData(e,!1),t.prototype.Show.call(this),r.AudioManager.Singleton.play("","pop_up"),h.default.instance.view.fisrtHuPos==h.default.instance.Model.myPos&&1==this.typeController.selectedIndex&&this.showShare()},e.prototype.playEffect=function(){for(var t=.2,e=0,i=this.ui_resoutList.numChildren;e<i;e++)(s=this.ui_resoutList.getChildAt(e)).node.opacity=0;for(e=0,i=this.ui_resoutList.numChildren;e<i;e++){var s=this.ui_resoutList.getChildAt(e);this.ui_resoutList.isChildInView(s)&&(s.playEffect(t),t+=.05)}},e.prototype.clean=function(){this.node.stopAllActions(),this.unscheduleAllCallbacks();for(var t=0,e=this.ui_resoutList.numChildren;t<e;t++){var i=this.ui_resoutList.getChildAt(t);fgui.GTween.kill(i)}this.ui_resoutList.removeChildren()},e.prototype.clickStart=function(){var t;h.default.instance.Model.goHall&&(null===(t=h.default.instance.view)||void 0===t||t.showWait(!0,this.startTime,this.times)),this.Hide()},e.prototype.Hide=function(){var e=this;if(this.ui_btn_share.visible){if(fgui.GTween.isTweening(this.ui_btn_share))return;var i=this.fguiComponent.width;fgui.GTween.to2(i-360,53,i+360,53,.5).setTarget(this.ui_btn_share,this.ui_btn_share.setPosition).onComplete(function(){cc.isValid(e.ui_btn_share)&&(e.ui_btn_share.visible=!1,r.AudioManager.Singleton.play("","btn_close"),t.prototype.Hide.call(e),h.default.instance.view.showWithdrawCom())})}else r.AudioManager.Singleton.play("","btn_close"),t.prototype.Hide.call(this),h.default.instance.view.showWithdrawCom()},e}(a.default);i.default=c,cc._RF.pop()},{"../../../../Boot/scirpt/AppConst":void 0,"../../../../Common/script/base/AudioManager":void 0,"../../../../Common/script/base/ReportManager":void 0,"../../../../Common/script/base/ViewBase":void 0,"../../../../GameHall/dlc/script/Common/CaptureUtils":void 0,"../Controller/RummyController":"RummyController"}],Rummy:[function(t,e,i){"use strict";cc._RF.push(e,"48834Kid7tJlbs5EqSDaGTb","Rummy"),Object.defineProperty(i,"__esModule",{value:!0}),i.PermutationAndCombination=i.RummySplitHelper=i.Rummy=void 0;var s,o=t("../../../../Common/script/util/UIUtil"),r=t("../Controller/RummyController"),n=function(){function t(){}return t.GetCardValue=function(t){return t<100?t:t%100},t.GetCompareColor=function(t){var e=Math.floor(t/100);return 2==e?e=4:1==e&&(e=3),3==e?2:1},t.CompareColor=function(e,i){return e<100||i<100?99:t.GetCompareColor(e)>t.GetCompareColor(i)?1:t.GetCompareColor(e)<t.GetCompareColor(i)?-1:0},t.CompareCard=function(e,i){return t.GetCardValue(e)>t.GetCardValue(i)||!(t.GetCardValue(e)<t.GetCardValue(i))&&1==t.CompareColor(e,i)},t.GroupSortByColor=function(t){for(var e=[],i=0;i<5;i++)e[i]=[];for(var s=0;s<t.length;s++){var o=Math.floor(t[s]/100);0==o?e[0].push(t[s]):2==o?e[1].push(t[s]):1==o?e[2].push(t[s]):3==o?e[3].push(t[s]):4==o&&e[4].push(t[s])}return e.filter(function(t){return t.length>0})},t.GroupSort=function(t,e){for(var i,s=this.GroupSortByColor(t),o=0;o<s.length;o++)s[o].sort();var r,n=e%100;r=16==e||17==e?[16,17,114,214,314,414]:[16,17,100+n,200+n,300+n,400+n];for(var a=[],l=0;l<s.length;l++)if(s[l].length>0){var u=this.findMaxS(s[l]);u.length>1?a.push.apply(a,u):1==u.length&&(u[0].length>1?a.push.apply(a,u):a.push(u))}var h=a.filter(function(t){return t.length>2}),c=a.filter(function(t){return 2==t.length}),p=a.filter(function(t){return 1==t.length}),d=[];for(l=p.length-1;l>=0;l--)16!=p[l][0]&&17!=p[l][0]&&p[l][0]%100!=e%100||(d.push(p[l][0]),p.splice(l,1));for(l=c.length-1;l>=0;l--){if(16==c[l][0]||17==c[l][0]){d.push.apply(d,c[l]),c.splice(l,1);break}c[l][0]%100==e%100?(d.push(c[l][0]),c[l].shift(),p.push(c[l]),c.splice(l,1)):c[l][1]%100==e%100?(d.push(c[l][1]),c[l].pop(),p.push(c[l]),c.splice(l,1)):Math.abs(c[l][0]%100-c[l][1]%100)>2&&(p.push([c[l][0]]),p.push([c[l][1]]),c.splice(l,1))}for(l=0;l<h.length;l++)if(h[l].length>3)if(h[l][0]%100==e%100){var m=h[l].shift();d.push(m)}else if(h[l][h[l].length-1]%100==e%100){var _=h[l].pop();d.push(_)}for(c.sort(function(t,e){return e[1]%100-e[0]%100-(t[1]%100-t[0]%100)}),l=p.length-1;l>0;l--){var f=p[l][0]%100;if(16!=f&&17!=f){var y=Math.floor(p[l][0]/100),g=p[l-1][0]%100;if((w=Math.floor(p[l-1][0]/100))==y&&g+2==f)c.unshift([p[l-1][0],p[l][0]]),p.splice(l,1),p.splice(l-1,1),l--;else if(14==f)for(var b=l-1;b>=0;b--){var v=Math.floor(p[b][0]/100),C=p[b][0]%100;if(v!=y)break;if(2==C||3==C){c.unshift([p[l][0],p[b][0]]),p.splice(l,1),p.splice(b,1),l--;break}}}}if(c.length>0&&d.length>0)for(l=0;l<c.length;l++){var P=d.pop();if(!P)break;c[l].push(P)}for(l=p.length-1;l>=0;l--){var w=Math.floor(p[l][0]/100);for(b=0;b<c.length;b++)if(w==(v=Math.floor(c[b][0]/100))){var k=c[b].concat();if(k.push(p[l][0]),this.GetRummyTypeWild(k,r)>0){c[b].push(p[l][0]),p.splice(l,1);break}}}var T=c.filter(function(t){return 2==t.length}),M=c.filter(function(t){return t.length>2}),S=[].concat.apply([],p),x=[].concat.apply([],T);S.push.apply(S,x);var I={};for(l=S.length-1;l>=0;l--)I[N=S[l]%100]?I[N].includes(S[l])||I[N].push(S[l]):(I[N]=[],I[N].push(S[l]));var R=[];for(var N in I)if(I[N].length>2){for(R.push(I[N]),l=0;l<I[N].length;l++)for(b=S.length-1;b>=0;b--)if(S[b]==I[N][l]){S.splice(b,1);break}}else if(2==I[N].length&&d.length>0){var A=[];for(A.push(d.pop()),A.push.apply(A,I[N]),M.push(A),l=0;l<I[N].length;l++)for(b=S.length-1;b>=0;b--)if(S[b]==I[N][l]){S.splice(b,1);break}}if(d.length>0)if(d.length>1&&S.length>0){var O=S.pop();d.push(O),M.push(d)}else M.length>0?(i=M[M.length-1]).push.apply(i,d):S.push.apply(S,d);for(S.reverse(),l=S.length-1;l>=0;l--)for(w=Math.floor(S[l]/100),b=0;b<M.length;b++)if(w==(v=Math.floor(M[b][0]/100))){var G=M[b].concat();if(G.push(S[l]),this.GetRummyTypeWild(G,r)>0){M[b].push(S[l]),S.splice(l,1);break}}M.length>0&&h.push.apply(h,M),R.length>0&&h.push.apply(h,R);for(var D=this.GroupSortByColor(S),E=[],F=0;F<D.length;F++)D[F].sort(),1==D[F].length?E.push.apply(E,D[F]):h.push(D[F]);return E.length>0&&h.push(E),1==h.length?s:h},t.findMaxS=function(t){var e=[];if(e.push.apply(e,t),e.length<=1)return e;var i=[],s=[];i.push(e[0]);var o=[],r=1;if(e.length>=3)if(3==e.length){if(e[0]%100==2&&e[1]%100==3&&e[e.length-1]%100==14){var n=e.pop();return i.unshift(n),i.push(e[1]),r=2,[i]}}else e[0]%100==2&&e[1]%100==3&&e[e.length-1]%100==14&&(n=e.pop(),i.unshift(n),i.push(e[1]),r=2);for(var a=r;a<e.length;a++)if(i[i.length-1]==e[a]){if(o.length>0&&o[o.length-1]+1==e[a]){var l=[];l.push(o.pop()),l.push(e[a]),s.push(l)}else o.push(e[a]);a==e.length-1&&s.push(i)}else i[i.length-1]+1==e[a]?(i.push(e[a]),a==e.length-1&&s.push(i)):(s.push(i.concat()),(i=[]).push(e[a]),a==e.length-1&&s.push(i));return o.length>0&&(o.length>2?this.shunzi(o)?s.push(o):s.push.apply(s,o.map(function(t){return[].concat(t)})):s.push(o)),s},t.AddorRemoveSelect=function(t,e){if(e)r.default.instance.Model.selectCard.push(t);else{var i=r.default.instance.Model.selectCard.indexOf(t);r.default.instance.Model.selectCard.splice(i,1)}},t.shunzi=function(t){var e=t.concat(),i=!1;if(e[e.length-1]-e[0]==e.length-1&&(i=!0),!i&&e[e.length-1]%100==14){var s=e[e.length-1];e.splice(e.length-1,1),e.unshift(s-13),e[e.length-1]-e[0]==e.length-1&&(i=!0)}return i},t.groupColorNum=function(t){for(var e=[],i=0;i<t.length;i++){var s=Math.floor(t[i]/100);-1==e.indexOf(s)&&e.push(s)}return e},t.GetRummyTypeWild=function(t,e){var i=s.Error;if(t.length<3)return i;t.sort(function(t,e){return t-e});var o=[];if(o.push.apply(o,t),this.IsFlush(t)){var r=t.concat();if(new Set(r).size==t.length&&this.shunzi(t))return s.FStraight_pure}var n,a=o.filter(function(t){return!e.includes(t)});if(n=o.length-a.length,o=null,0==(o=a).length)return t.length;var l=this.IsFlush(o),u=this.groupColorNum(o),h=this.OrderPaiLordNoColor(o,u);if(l){for(var c=!1,p=0,d=0;d<h.length-1;d++){if(!(h[d]-h[d+1]<=n+1-p&&h[d]-h[d+1]!=0)){c=!1;break}p+=h[d]-h[d+1]-1,c=!0}if(14==h[0]&&!c&&h.length>1)for(p=0,h.splice(0,1),h.push(1),d=0;d<h.length-1;d++){if(!(h[d]-h[d+1]<=n+1-p&&h[d]-h[d+1]!=0)){c=!1;break}p+=h[d]-h[d+1]-1,c=!0}(c||1==h.length)&&(i=h.length+n)}else switch(h.length){case 2:this.IsSame(h,2)&&2==u.length&&(1==n&&(i=s.Three_3),2==n&&(i=s.Bomb_4));break;case 3:this.IsSame(h,3)&&3==u.length&&(i=s.Three_3,1==n&&(i=s.Bomb_4),n>1&&(i=s.Error));break;case 4:this.IsSame(h,4)&&0==n&&4==u.length&&(i=s.Bomb_4)}return i},t.OrderPaiLordNoColor=function(t,e){var i=[];o.UIUtil.Concat(i,t);for(var s=0;s<i.length;s++){var r=o.UIUtil.NumberToInt(i[s]/100);i[s]>100&&(i[s]%=100),-1==e.indexOf(r)&&e.push(r)}var n=[];return n.push.apply(n,i),n.sort(function(t,e){return e-t}),n},t.IsFlush=function(t){for(var e=!0,i=Math.floor(t[0]/100),s=1;s<t.length;s++)if(i!=Math.floor(t[s]/100))return!1;return e},t.ColorIsStraight=function(e){if(!this.IsFlush(e))return!1;var i=t.OrderPaiLordNoColor(e,[]);return this.IsStraight(i)},t.IsStraight=function(t){for(var e=!1,i=0;i<t.length-1;i++){if(t[i]-1!=t[i+1]){e=!1;break}e=!0}if(14==t[0]&&!e&&t.length>1)for(t.splice(0,1),t.push(1),i=0;i<t.length-1;i++){if(t[i]-1!=t[i+1]){e=!1;break}e=!0}return e},t.IsSame=function(t,e){for(var i=!1,s=!1,o=0;o<e-1;o++){if(t[o]!=t[o+1]){i=!1;break}i=!0}for(o=t.length-1;o>t.length-e;o--){if(t[o]!=t[o-1]){s=!1;break}s=!0}return!(!i&&!s)},t.GetCombinationCard=function(t,e){if(13!=t.length&&14!=t.length)return cc.error("\u4f20\u5165\u7684\u624b\u724c\u4e0d\u5bf9"),[];t=this.OrderPai(t);var i={bool:!1},s=new l;if(13==t.length)return s.Split(t,e),s.GetCombinationCard(t,e,i);for(var r=0,n=[],a=[],u=0;u<t.length;u++){n=[],o.UIUtil.Concat(n,t),n.splice(u,1),s.Split(n,e);var h=s.GetCombinationCard(n,e,i),c=h.length;if(i.bool)return h;c>r&&(a=[],o.UIUtil.Concat(a,h),r=c)}return a},t.OrderPai=function(t){var e=[];return o.UIUtil.Concat(e,t),e.sort(),e},t.GetPoker_Count=function(t){var e=new Map;return t.forEach(function(t){e.has(t)?e.set(t,e.get(t)+1):e.set(t,1)}),e},t}();i.Rummy=n,function(t){t[t.Error=0]="Error",t[t.Three_3=1]="Three_3",t[t.Bomb_4=2]="Bomb_4",t[t.FStraight3_3=3]="FStraight3_3",t[t.FStraight4_4=4]="FStraight4_4",t[t.FStraight5_5=5]="FStraight5_5",t[t.FStraight6_6=6]="FStraight6_6",t[t.FStraight7_7=7]="FStraight7_7",t[t.FStraight8_8=8]="FStraight8_8",t[t.FStraight9_9=9]="FStraight9_9",t[t.FStraight10_10=10]="FStraight10_10",t[t.FStraight11_11=11]="FStraight11_11",t[t.FStraight12_12=12]="FStraight12_12",t[t.FStraight13_13=13]="FStraight13_13",t[t.FStraight_pure=14]="FStraight_pure"}(s||(s={}));var a,l=function(){function t(){this.cards=[],this._cardsnocolor=[],this._one=[],this._two=[],this._three=[],this._four=[],this._single=[],this._double=[],this._threeList=[],this._straight=[],this._sequence=[],this._bomb4List=[],this._wildlist=[],this._heart=[],this._spade=[],this._club=[],this._diamond=[],this._comCard=[]}return t.prototype.Split=function(t,e,i){void 0===i&&(i=!1),this.cards=[],o.UIUtil.Concat(this.cards,t),this._wild=e,this._wildforstra=i,this._cardsnocolor=n.OrderPaiLordNoColor(t,[]),this.SearchWild(),this.SearchColor(),this.SearchBase(),this.SearchBomb(),this.Search123(),this._straight=[],this.SearchStraight(this._diamond),this.SearchStraight(this._club),this.SearchStraight(this._spade),this.SearchStraight(this._heart)},t.prototype.SearchColor=function(){var t=this;this.cards.forEach(function(e){4==Math.floor(e/100)&&t._diamond.push(e),3==Math.floor(e/100)&&t._club.push(e),2==Math.floor(e/100)&&t._spade.push(e),1==Math.floor(e/100)&&t._heart.push(e)})},t.prototype.SearchWild=function(){var t=this;this.cards.forEach(function(e){e!=a.jokers16&&e!=a.jokersb17||t._wildlist.push(e),e%100==t._wild%100&&t._wildlist.push(e)})},t.prototype.iswild=function(t){return this._wildlist.indexOf(t)>=0},t.prototype.SearchBase=function(){var t=this,e=n.GetPoker_Count(this._cardsnocolor);e.forEach(function(i,s){4==e.get(s)?(t._one.push(s),t._two.push(s),t._three.push(s),t._four.push(s)):3==e.get[s]?(t._one.push(s),t._two.push(s),t._three.push(s)):2==e.get[s]?(t._one.push(s),t._two.push(s)):1==e.get(s)&&t._one.push(s)}),this._one=n.OrderPaiLordNoColor(this._one,[]),this._two=n.OrderPaiLordNoColor(this._two,[]),this._three=n.OrderPaiLordNoColor(this._three,[]),this._four=n.OrderPaiLordNoColor(this._four,[])},t.prototype.SearchBomb=function(){this._bomb4List=[],o.UIUtil.Concat(this._bomb4List,this._four)},t.prototype.Search123=function(){this._single=[],o.UIUtil.Concat(this._single,this._one),this._double=[],o.UIUtil.Concat(this._double,this._two),this._threeList=[],o.UIUtil.Concat(this._threeList,this._three)},t.prototype.SearchStraight=function(t){if(!(t.length<3)){var e=[];o.UIUtil.Concat(e,t);for(var i=[],s=!1,r=0;r<t.length-1;r++)if((a=!1)&&(this.iswild(t[r])||this.iswild(t[r+1]))&&(a=!0),t[r]==t[r+1]-1||a)i.push(t[r]),r+1==t.length-1&&i.push(t[r+1]);else{if(i.push(t[r]),i.length>=3)this._straight.push(i);else if(r==t.length-2&&t[r+1]%100==14){s=!0;var n=e[r+1]/100*100+1;e.splice(r+1,1),e.unshift(n)}i=[]}if(i.length<3&&(i.forEach(function(t){if(t%100==14){s=!0;var i=t/100*100+1;e.splice(e.indexOf(t),1),e.unshift(i)}}),i=[]),s)for(r=0;r<e.length-1;r++){var a;(a=!1)&&(this.iswild(e[r])||this.iswild(e[r+1]))&&(a=!0),e[r]==e[r+1]-1||a?(e[r]%100==1&&(e[r]=e[r]/100*100+14),i.push(e[r]),r+1==e.length-1&&i.push(e[r+1])):(i.push(e[r]),i.length>=3&&this._straight.push(i),i=[])}i.length>=3&&this._straight.push(i)}},t.prototype.SearchMostCountSequece=function(){for(var t=this,e=0;e<this._straight.length;e++){var i=this._straight[e];if(3==i.length)this._sequence.push(i);else for(var s=3;s<=i.length;s++)u.GetCombination2(i,s).forEach(function(e){t._wildforstra?n.GetRummyTypeWild(t.cards,t._wildlist)>=3&&t._sequence.push(e):n.ColorIsStraight(e)&&t._sequence.push(e)})}},t.prototype.TryGetFirstLife=function(){return!(this._straight.length<1||(this.SearchMostCountSequece(),0))},t.prototype.GetCombinationCard=function(t,e,i){var s;if(this._comCard.length=0,i.bool=!1,!this.TryGetFirstLife())return this._comCard.push(t),this._comCard;for(var o=0;o<this._sequence.length;o++){var r=[];if(this._sequence[o].forEach(function(e){t.splice(t.indexOf(e),1)}),this.CheckHuSecond(t,r,this._comCard))return this._comCard=[],this._comCard.push(this._sequence[o]),(s=this._comCard).push.apply(s,r),i.bool=!0,this._comCard;t.push.apply(t,this._sequence[o]),this._comCard.push(this._sequence[o])}return this._comCard.forEach(function(e){e.forEach(function(e){t.splice(t.indexOf(e),1)})}),t.length>0&&this._comCard.push(t),this._comCard},t.prototype.CheckHuSecond=function(t,e,i){var s=this;if(e.length=0,i.length=0,t.length<3)return!1;if(this._wildforstra=!0,n.GetRummyTypeWild(t,this._wildlist)>=3)return e.push(t),!0;for(var r=[],a=3;a<=t.length;a++)u.GetCombination2(t,a).forEach(function(t){var e=[];o.UIUtil.Concat(e,t),n.GetRummyTypeWild(e,s._wildlist)>=3&&r.push(e)});for(var l=[],h=[],c=0;c<r.length;c++){if(r[c].forEach(function(e){t.splice(t.indexOf(e),1)}),0==t.length)return e.push(r[c]),!0;var p=[];if(this.CheckHuMax7(t,p,h))return e.push(r[c]),e.push.apply(e,p),!0;t.push.apply(t,r[c]),l.length=0,o.UIUtil.Concat(l,r[c])}return l.length>0&&i.push(l),h.length>0&&i.push(h),!1},t.prototype.CheckHuMax7=function(t,e,i){var r=this;if(e.length=0,i.length=0,t.length<3)return!1;if(n.GetRummyTypeWild(t,this._wildlist)!=s.Error)return e.push(t),!0;for(var a=[],l=3;l<=t.length;l++)u.GetCombination2(t,l).forEach(function(t){var e=[];o.UIUtil.Concat(e,t);var i=n.GetRummyTypeWild(e,r._wildlist)!=s.Error;i?a.push(e):0!=i||3!=t.length&&4!=t.length||n.GetRummyTypeWild(e,r._wildlist)!=s.Error&&a.push(e)});for(var h=0;h<a.length;h++){if(a[h].forEach(function(e){t.splice(t.indexOf(e),1)}),0==t.length)return e.push(a[h]),!0;var c=[];if(this.CheckHuMax4(t,c))return e.push(a[h]),e.push(c),!0;t.push.apply(t,a[h]),i.length=0,o.UIUtil.Concat(i,a[h])}return!1},t.prototype.CheckHuMax4=function(t,e){return e.length=0,!(t.length<3||n.GetRummyTypeWild(t,this._wildlist)==s.Error||(o.UIUtil.Concat(e,t),0))},t.prototype.ColorIsStraight=function(t){var e=[];if(o.UIUtil.Concat(e,t),this._wildlist.forEach(function(t){e.indexOf(t)>=0&&e.splice(e.indexOf(t),1)}),!this.IsFlushW(e))return!1;var i=n.OrderPaiLordNoColor(e,[]);return this.IsStraightW(i)},t.prototype.IsStraightW=function(t){for(var e=!1,i=0;i<t.length-1;i++){if(t[i]-1!=t[i+1]){e=!1;break}e=!0}return e},t.prototype.IsFlushW=function(t){for(var e=!0,i=t[0]/100,s=1;s<t.length;s++)if(i!=t[s]/100){e=!1;break}return e},t.IsFlush=function(t){var e=!0;if(0==t.length)return e;for(var i=t[0]/100,s=1;s<t.length;s++)if(i!=t[s]/100){e=!1;break}return e},t.IsStraight=function(t){var e=!1;if(t.length<3)return e;for(var i=0;i<t.length-1;i++){if(t[i]-1!=t[i+1]){e=!1;break}e=!0}if(14==t[0]&&!e&&t.length>1)for(t.splice(0,1),t.push(1),i=0;i<t.length-1;i++){if(t[i]-1!=t[i+1]){e=!1;break}e=!0}return e},t}();i.RummySplitHelper=l,function(t){t[t.p2=2]="p2",t[t.p3=3]="p3",t[t.p4=4]="p4",t[t.p5=5]="p5",t[t.p6=6]="p6",t[t.p7=7]="p7",t[t.p8=8]="p8",t[t.p9=9]="p9",t[t.p10=10]="p10",t[t.p11=11]="p11",t[t.p12=12]="p12",t[t.p13=13]="p13",t[t.p14=14]="p14",t[t.jokers16=16]="jokers16",t[t.jokersb17=17]="jokersb17"}(a||(a={}));var u=function(){function t(){}return t.Swap=function(t,e){var i=t;t=e,e=i},t.GetCombination=function(t,e,i,s,o,r){for(var n=i;n>=s;n--)if(o[s-1]=n-1,s>1)this.GetCombination(t,e,n-1,s-1,o,r);else{null==t&&(t=[]);for(var a=[],l=0;l<o.length;l++)a[l]=e[o[l]];t.push(a)}},t.GetPermutation=function(t,e,i,s){if(i==s){null==t&&(t=[]);var r=[];o.UIUtil.Concat(r,e),t.push(r)}else for(var n=i;n<=s;n++)this.Swap(e[i],e[n]),this.GetPermutation(t,e,i+1,s),this.Swap(e[i],e[n])},t.GetPermutation2=function(t,e,i){if(e<0||i>t.length-1)return null;var s=[];return this.GetPermutation(s,t,e,i),s},t.GetPermutation3=function(t){return this.GetPermutation2(t,0,t.length-1)},t.GetPermutation4=function(t,e){if(e>t.length)return null;for(var i=[],s=this.GetCombination2(t,e),o=0;o<s.length;o++){var r=[];this.GetPermutation(r,s[o],0,e-1),i.concat(r)}return i},t.GetCombination2=function(t,e){if(t.length<e)return null;var i=[];return this.GetCombination(i,t,t.length,e,[],e),i},t}();i.PermutationAndCombination=u,cc._RF.pop()},{"../../../../Common/script/util/UIUtil":void 0,"../Controller/RummyController":"RummyController"}]},{},["RummyController","Rummy","RummyModel","GroupTitle","MainScene","Player","Poker","RummyFinish","RummyHelp","RummyResout","RummyResoutItem"]);